

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>PyGSLIB API autogenerated documentation! &mdash; PyGSLIB 0.0.0.3.8 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PyGSLIB 0.0.0.3.8 documentation" href="index.html"/>
        <link rel="prev" title="Welcome to PyGSLIB documentation!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> PyGSLIB
          

          
          </a>

          
            
            
              <div class="version">
                0.0.0.3.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">PyGSLIB API autogenerated documentation!</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pygslib.gslib">PyGSLIB.gslib</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pygslib.drillhole">PyGSLIB.drillhole</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pygslib.blockmodel">PyGSLIB.blockmodel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pygslib.vtktools">PyGSLIB.vtktools</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pygslib.nonlinear">PyGSLIB.nonlinear</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">PyGSLIB</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>PyGSLIB API autogenerated documentation!</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/API.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pygslib-api-autogenerated-documentation">
<h1>PyGSLIB API autogenerated documentation!<a class="headerlink" href="#pygslib-api-autogenerated-documentation" title="Permalink to this headline">¶</a></h1>
<p>Contents:</p>
<div class="section" id="module-pygslib.gslib">
<span id="pygslib-gslib"></span><h2>PyGSLIB.gslib<a class="headerlink" href="#module-pygslib.gslib" title="Permalink to this headline">¶</a></h2>
<p>PyGSLIB.gslib, Module to interface GSLIB programs. This includes the
standard programs available at
<a class="reference external" href="http://www.statios.com/software/gslib77_ls.tar.gz">http://www.statios.com/software/gslib77_ls.tar.gz</a> and non-standard GSLIB
programs provided by contributors.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The original Fortran 77 code was modified. That was required to convert
the existing standalone executables into shared libraries. The original
code was also modified to introduce extra functionality, for example,
maximum number of samples per drillhole in the program <code class="docutils literal"><span class="pre">kt3D</span></code> and
variogram cloud in the program <code class="docutils literal"><span class="pre">gamv</span></code>. The main changes consisted of:</p>
<blockquote>
<div><ul class="simple">
<li>the old Fortran 77 as converted to Fortran 90.</li>
<li>data and parameters are directly transferred between
Fortran and Python functions and not through data files
and parameter files.</li>
</ul>
</div></blockquote>
<p>Copyright 2016, Adrian Martinez Vargas</p>
<p class="last">This software may be modified and distributed under the terms
of the MIT license.  See the LICENSE.txt file for details.</p>
</div>
<dl class="function">
<dt id="pygslib.gslib.addcoord">
<code class="descclassname">pygslib.gslib.</code><code class="descname">addcoord</code><span class="sig-paren">(</span><em>nx</em>, <em>ny</em>, <em>nz</em>, <em>xmn</em>, <em>ymn</em>, <em>zmn</em>, <em>xsiz</em>, <em>ysiz</em>, <em>zsiz</em>, <em>grid</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.gslib.addcoord" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert X, Y, Z coordinates into a grid file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nx,ny,nz</strong> (<em>int</em>) &#8211; number of rows.</li>
<li><strong>xmn,ymn,zmn</strong> (<em>double</em>) &#8211; origin of coordinates (block centroid).</li>
<li><strong>xsiz,ysiz,zsiz</strong> (<em>double</em>) &#8211; block sizes.</li>
<li><strong>grid</strong> (<em>DataFrame</em>) &#8211; Pandas dataframe with the input grid variables.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>data</strong> &#8211; Pandas dataframe (the grid) with extra columns x, y, z.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Pandas DataFrame</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The input grid is expected to have xmn*ymn*zmn rows
with GEOEAS grid order</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.gslib.block_covariance">
<code class="descclassname">pygslib.gslib.</code><code class="descname">block_covariance</code><span class="sig-paren">(</span><em>parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.gslib.block_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates block covariance</p>
<p>This function calculates the block covariance given a variogram
model.
The anisotropy can be different in each nested structure.
The block size is defined by input discretization points. Note
that discretization points can have any arbitrary locations,
for example</p>
<blockquote>
<div><ul class="simple">
<li>regular discretization</li>
<li>random  discretization</li>
<li>or discretization in an irregular polygon</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parameters</strong> (<em>dict</em>) &#8211; dictionary with calculation parameters</td>
</tr>
</tbody>
</table>
<p>Parameters are E-Type in a dictionary as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1"># Coordinates of the discretization points</span>
   <span class="s1">&#39;xdb&#39;</span>  <span class="p">:</span>  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># array(&#39;f&#39;)</span>
   <span class="s1">&#39;ydb&#39;</span>  <span class="p">:</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="c1"># array(&#39;f&#39;)</span>
   <span class="s1">&#39;zdb&#39;</span>  <span class="p">:</span>  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="c1"># array(&#39;f&#39;)</span>
  <span class="c1"># Variogram model</span>
   <span class="s1">&#39;it&#39;</span>   <span class="p">:</span>  <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>       <span class="c1"># structure type, array(&#39;i&#39;)  with bounds (nst)</span>
   <span class="s1">&#39;c0&#39;</span>   <span class="p">:</span>  <span class="p">[</span><span class="mf">0.1</span><span class="p">],</span>        <span class="c1"># nugget, array(&#39;f&#39;)</span>
   <span class="s1">&#39;cc&#39;</span>   <span class="p">:</span>  <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>   <span class="c1"># variance, array(&#39;f&#39;)  with bounds (nst)</span>
   <span class="s1">&#39;aa&#39;</span>   <span class="p">:</span>  <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>      <span class="c1"># ranges in main direction, array(&#39;f&#39;)   with bounds (nst)</span>
   <span class="s1">&#39;aa1&#39;</span>  <span class="p">:</span>  <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>      <span class="c1"># ranges in second direction, array(&#39;f&#39;) with bounds (nst)</span>
   <span class="s1">&#39;aa2&#39;</span>  <span class="p">:</span>  <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>      <span class="c1"># ranges in third direction, array(&#39;f&#39;)  with bounds (nst)</span>
   <span class="s1">&#39;ang1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>        <span class="c1"># input rank-1 array(&#39;d&#39;) with bounds (nst)</span>
   <span class="s1">&#39;ang2&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>        <span class="c1"># input rank-1 array(&#39;d&#39;) with bounds (nst)</span>
   <span class="s1">&#39;ang3&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}</span>        <span class="c1"># input rank-1 array(&#39;d&#39;) with bounds (nst)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>cbb</strong> &#8211; block covariance.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pygslib</span><span class="o">.</span><span class="n">gslib</span><span class="o">.</span><span class="n">block_covariance</span><span class="p">(</span><span class="n">parameters_blk</span><span class="p">)</span>
<span class="go">0.803182760643</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.gslib.check_gamv_par">
<code class="descclassname">pygslib.gslib.</code><code class="descname">check_gamv_par</code><span class="sig-paren">(</span><em>parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.gslib.check_gamv_par" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the variogram calculation parameters</p>
<p>Verifies the parameters of the <code class="docutils literal"><span class="pre">gamv</span></code> function
and checks for possible errors or inconsistencies</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parameters</strong> (<em>dict</em>) &#8211; dictionary with calculation parameters</td>
</tr>
</tbody>
</table>
<p>The dictionary with parameters may be as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1"># Coordinates of the data points</span>
   <span class="s1">&#39;x&#39;</span>      <span class="p">:</span>  <span class="n">X</span><span class="p">,</span>              <span class="c1"># array(&#39;f&#39;) with bounds (nd), nd is number of data points</span>
   <span class="s1">&#39;y&#39;</span>      <span class="p">:</span>  <span class="n">Y</span><span class="p">,</span>              <span class="c1"># array(&#39;f&#39;) with bounds (nd)</span>
   <span class="s1">&#39;z&#39;</span>      <span class="p">:</span>  <span class="n">Z</span><span class="p">,</span>              <span class="c1"># array(&#39;f&#39;) with bounds (nd)</span>
   <span class="s1">&#39;bhid&#39;</span>   <span class="p">:</span>  <span class="n">bhid</span><span class="p">,</span>           <span class="c1"># drillhole id for downhole variogram, array(&#39;i&#39;) with bounds (nd)</span>
   <span class="s1">&#39;vr&#39;</span>     <span class="p">:</span>  <span class="n">VR</span><span class="p">,</span>             <span class="c1"># Variables, array(&#39;f&#39;) with bounds (nd,nv), nv is number of variables</span>
   <span class="s1">&#39;tmin&#39;</span>   <span class="p">:</span> <span class="o">-</span><span class="mf">1.0e21</span><span class="p">,</span>         <span class="c1"># trimming limits, float</span>
   <span class="s1">&#39;tmax&#39;</span>   <span class="p">:</span>  <span class="mf">1.0e21</span><span class="p">,</span>         <span class="c1"># trimming limits, float</span>
   <span class="s1">&#39;nlag&#39;</span>   <span class="p">:</span>  <span class="mi">10</span><span class="p">,</span>             <span class="c1"># number of lags, int</span>
   <span class="s1">&#39;xlag&#39;</span>   <span class="p">:</span>  <span class="mi">4</span><span class="p">,</span>              <span class="c1"># lag separation distance, float</span>
   <span class="s1">&#39;xltol&#39;</span>  <span class="p">:</span>  <span class="mi">2</span><span class="p">,</span>              <span class="c1"># lag tolerance, float</span>
   <span class="s1">&#39;azm&#39;</span>    <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span>        <span class="c1"># azimuth, array(&#39;f&#39;) with bounds (ndir)</span>
   <span class="s1">&#39;atol&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span><span class="mf">22.5</span><span class="p">,</span><span class="mf">22.5</span><span class="p">],</span>  <span class="c1"># azimuth tolerance, array(&#39;f&#39;) with bounds (ndir)</span>
   <span class="s1">&#39;bandwh&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>      <span class="c1"># bandwidth h, array(&#39;f&#39;) with bounds (ndir)</span>
   <span class="s1">&#39;dip&#39;</span>    <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>         <span class="c1"># dip, array(&#39;f&#39;) with bounds (ndir)</span>
   <span class="s1">&#39;dtol&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>      <span class="c1"># dip tolerance, array(&#39;f&#39;) with bounds (ndir)</span>
   <span class="s1">&#39;bandwd&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>      <span class="c1"># bandwidth d, array(&#39;f&#39;) with bounds (ndir)</span>
   <span class="s1">&#39;isill&#39;</span>  <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>               <span class="c1"># standardize sills? (0=no, 1=yes), int</span>
   <span class="s1">&#39;sills&#39;</span>  <span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">],</span>           <span class="c1"># variance used to std the sills, array(&#39;f&#39;) with bounds (nv)</span>
   <span class="s1">&#39;ivtail&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="c1"># tail var., array(&#39;i&#39;) with bounds (nvarg), nvarg is number of variograms</span>
   <span class="s1">&#39;ivhead&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="c1"># head var., array(&#39;i&#39;) with bounds (nvarg)</span>
   <span class="s1">&#39;ivtype&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="c1"># variogram type, array(&#39;i&#39;) with bounds (nvarg)</span>
   <span class="s1">&#39;maxclp&#39;</span> <span class="p">:</span> <span class="mi">50000</span><span class="p">}</span>           <span class="c1"># maximum number of variogram point cloud to use, input int</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>out</strong> &#8211; return True (or 1) if the parameter dictionary is valid</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">pygslib</span><span class="o">.</span><span class="n">gslib</span><span class="o">.</span><span class="n">check_gamv_par</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">,</span> <span class="s1">&#39;sorry this parameter file is wrong&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.gslib.cova3">
<code class="descclassname">pygslib.gslib.</code><code class="descname">cova3</code><span class="sig-paren">(</span><em>parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.gslib.cova3" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates variogram values given a variogram function and direction</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parameters</strong> (<em>dict</em>) &#8211; dictionary with calculation parameters</td>
</tr>
</tbody>
</table>
<p>The dictionary with parameters may be as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1"># Coordinates of point 1 and 2</span>
   <span class="s1">&#39;x1&#39;</span>    <span class="p">:</span>  <span class="mi">0</span><span class="p">,</span>         <span class="c1"># X coordinates, point 1, float</span>
   <span class="s1">&#39;y1&#39;</span>    <span class="p">:</span>  <span class="mi">0</span><span class="p">,</span>         <span class="c1"># Y coordinates, point 1, float</span>
   <span class="s1">&#39;z1&#39;</span>    <span class="p">:</span>  <span class="mi">0</span><span class="p">,</span>         <span class="c1"># Z coordinates, point 1, float</span>
   <span class="s1">&#39;x2&#39;</span>    <span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>         <span class="c1"># X coordinates, point 2, float</span>
   <span class="s1">&#39;y2&#39;</span>    <span class="p">:</span>  <span class="mi">0</span><span class="p">,</span>         <span class="c1"># Y coordinates, point 2, float</span>
   <span class="s1">&#39;z2&#39;</span>    <span class="p">:</span>  <span class="mi">0</span><span class="p">,</span>         <span class="c1"># Z coordinates, point 2, float</span>
  <span class="c1"># Variogram model</span>
   <span class="s1">&#39;nst&#39;</span>   <span class="p">:</span>  <span class="mi">2</span><span class="p">,</span>         <span class="c1"># number of nested structures</span>
   <span class="s1">&#39;it&#39;</span>    <span class="p">:</span>  <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>    <span class="c1"># structure type,  array(&#39;i&#39;) with bounds (ivarg)</span>
   <span class="s1">&#39;c0&#39;</span>    <span class="p">:</span>  <span class="p">[</span><span class="mf">0.1</span><span class="p">],</span>     <span class="c1"># nugget,  array(&#39;f&#39;) with bounds (ivarg)</span>
   <span class="s1">&#39;cc&#39;</span>    <span class="p">:</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">],</span>  <span class="c1"># variance, array(&#39;f&#39;) with bounds (nvarg*nst[0])</span>
   <span class="s1">&#39;aa&#39;</span>    <span class="p">:</span>  <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span>   <span class="c1"># parameter a (or range), array(&#39;f&#39;) with bounds (nvarg*nst[0])</span>
   <span class="s1">&#39;irot&#39;</span>  <span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>         <span class="c1"># index of the rotation matrix for the first nested structure</span>
                         <span class="c1"># the second nested structure will use irot+1, the third irot+2, and so on</span>
   <span class="s1">&#39;rotmat&#39;</span><span class="p">:</span>  <span class="n">rotmat</span><span class="p">}</span>    <span class="c1"># rotation matrices (output of the function setrot)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>cmax,cova</strong> &#8211; cmax is the maximum covariance value (required to invert the variogram into covariance function)
cova is the actual covariance value.<p>Note: The variogram can be calculated as v= cmax - cova</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float64, float64</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">rotmat may be obtained with setrot</p>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">calculate irot and rotmat internally and remove it from parameter dict.</p>
</div>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># this is the covariance between the points x1, x2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmax</span><span class="p">,</span><span class="n">cova</span><span class="o">=</span><span class="n">pygslib</span><span class="o">.</span><span class="n">gslib</span><span class="o">.</span><span class="n">cova3</span><span class="p">(</span><span class="n">parameters_mod</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">cmax</span><span class="p">,</span> <span class="n">cova</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">2.40999984741</span> <span class="mf">2.24302244186</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.gslib.declus">
<code class="descclassname">pygslib.gslib.</code><code class="descname">declus</code><span class="sig-paren">(</span><em>parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.gslib.declus" title="Permalink to this definition">¶</a></dt>
<dd><p>Decluster data and run declustering test with different
declustering cell sizes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parameters</strong> (<em>dict</em>) &#8211; dictionary with calculation parameters</td>
</tr>
</tbody>
</table>
<p>The dictionary with parameters may be as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
       <span class="c1"># database</span>
        <span class="s1">&#39;x&#39;</span>      <span class="p">:</span>  <span class="n">mydata</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>     <span class="c1"># data x coordinates, array(&#39;f&#39;) with bounds (na), na is number of data points</span>
        <span class="s1">&#39;y&#39;</span>      <span class="p">:</span>  <span class="n">mydata</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>     <span class="c1"># data y coordinates, array(&#39;f&#39;) with bounds (na)</span>
        <span class="s1">&#39;z&#39;</span>      <span class="p">:</span>  <span class="n">mydata</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>     <span class="c1"># data z coordinates, array(&#39;f&#39;) with bounds (na)</span>
        <span class="s1">&#39;vr&#39;</span>     <span class="p">:</span>  <span class="n">mydata</span><span class="o">.</span><span class="n">vr</span><span class="p">,</span>    <span class="c1"># variable, array(&#39;f&#39;) with bounds (na)</span>
       <span class="c1"># cell size</span>
        <span class="s1">&#39;anisy&#39;</span>  <span class="p">:</span>  <span class="mf">5.</span><span class="p">,</span>           <span class="c1"># Y cell anisotropy (Ysize=size*Yanis), &#39;f&#39;</span>
        <span class="s1">&#39;anisz&#39;</span>  <span class="p">:</span>  <span class="mf">3.</span><span class="p">,</span>           <span class="c1"># Z cell anisotropy (Zsize=size*Zanis), &#39;f&#39;</span>
        <span class="s1">&#39;minmax&#39;</span> <span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>            <span class="c1"># 0=look for minimum declustered mean (1=max), &#39;i&#39;</span>
        <span class="s1">&#39;ncell&#39;</span>  <span class="p">:</span>  <span class="mi">10</span><span class="p">,</span>           <span class="c1"># number of cell sizes, &#39;i&#39;</span>
        <span class="s1">&#39;cmin&#39;</span>   <span class="p">:</span>  <span class="mi">5</span><span class="p">,</span>            <span class="c1"># minimum cell sizes, &#39;i&#39;</span>
        <span class="s1">&#39;cmax&#39;</span>   <span class="p">:</span>  <span class="mi">50</span><span class="p">,</span>           <span class="c1"># maximum cell sizes, &#39;i&#39;. Will be update to cmin if ncell == 1</span>
        <span class="s1">&#39;noff&#39;</span>   <span class="p">:</span>  <span class="mi">8</span><span class="p">,</span>            <span class="c1"># number of origin offsets, &#39;i&#39;. This is to avoid local minima/maxima</span>
        <span class="s1">&#39;maxcel&#39;</span> <span class="p">:</span>  <span class="mi">100000</span><span class="p">}</span>       <span class="c1"># maximum number of cells, &#39;i&#39;. This is to avoid large calculations, if MAXCEL&lt;1 this check will be ignored</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>wtopt</strong> (<em>rank-1 array(&#8216;d&#8217;) with bounds (nd), weight value</em>)</li>
<li><strong>vrop</strong> (<em>float, declustered mean</em>)</li>
<li><strong>wtmin</strong> (<em>float, weight minimum</em>)</li>
<li><strong>wtmax</strong> (<em>float, weight maximum</em>)</li>
<li><strong>error</strong> (<em>int,   runtime error:</em>) &#8211; error = 10   ! ncellt &gt; MAXCEL &#8216; check for outliers - increase cmin and/or MAXCEL&#8217;
error = 1    ! allocation error
error = 2    ! deallocation error</li>
<li><strong>xinc</strong> (<em>float, cell size increment</em>)</li>
<li><strong>yinc</strong> (<em>float, cell size increment</em>)</li>
<li><strong>zinc</strong> (<em>float, cell size increment</em>)</li>
<li><strong>rxcs</strong> (<em>rank-1 array(&#8216;d&#8217;) with bounds (ncell + 1), xcell size</em>)</li>
<li><strong>rycs</strong> (<em>rank-1 array(&#8216;d&#8217;) with bounds (ncell + 1), ycell size</em>)</li>
<li><strong>rzcs</strong> (<em>rank-1 array(&#8216;d&#8217;) with bounds (ncell + 1), zcell size</em>)</li>
<li><strong>rvrcr</strong> (<em>rank-1 array(&#8216;d&#8217;) with bounds (ncell + 1), declustering weight</em>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Minimun and maximum valid data values are not tested. Filter out <code class="docutils literal"><span class="pre">vr</span></code>
values before using this function.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.gslib.gam">
<code class="descclassname">pygslib.gslib.</code><code class="descname">gam</code><span class="sig-paren">(</span><em>parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.gslib.gam" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates experimental variograms on gridded data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parameters</strong> (<em>dict</em>) &#8211; dictionary with calculation parameters</td>
</tr>
</tbody>
</table>
<p>The dictionary with parameters may be as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;nx&#39;</span>     <span class="p">:</span>  <span class="mi">50</span><span class="p">,</span>       <span class="c1"># number of rows in the gridded data</span>
        <span class="s1">&#39;ny&#39;</span>     <span class="p">:</span>  <span class="mi">50</span><span class="p">,</span>       <span class="c1"># number of columns in the gridded data</span>
        <span class="s1">&#39;nz&#39;</span>     <span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>        <span class="c1"># number of levels in the gridded data</span>
        <span class="s1">&#39;xsiz&#39;</span>   <span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>        <span class="c1"># size of the cell in x direction</span>
        <span class="s1">&#39;ysiz&#39;</span>   <span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>        <span class="c1"># size of the cell in y direction</span>
        <span class="s1">&#39;zsiz&#39;</span>   <span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>        <span class="c1"># size of the cell in z direction</span>
        <span class="s1">&#39;bhid&#39;</span>   <span class="p">:</span>  <span class="n">bhid</span><span class="p">,</span>     <span class="c1"># bhid for downhole variogram, array(&#39;i&#39;) with bounds (nd)</span>
        <span class="s1">&#39;vr&#39;</span>     <span class="p">:</span>  <span class="n">VR</span><span class="p">,</span>       <span class="c1"># Variables, array(&#39;f&#39;) with bounds (nd*nv), nv is number of variables</span>
        <span class="s1">&#39;tmin&#39;</span>   <span class="p">:</span> <span class="o">-</span><span class="mf">1.0e21</span><span class="p">,</span>   <span class="c1"># trimming limits, float</span>
        <span class="s1">&#39;tmax&#39;</span>   <span class="p">:</span>  <span class="mf">1.0e21</span><span class="p">,</span>   <span class="c1"># trimming limits, float</span>
        <span class="s1">&#39;nlag&#39;</span>   <span class="p">:</span>  <span class="mi">10</span><span class="p">,</span>       <span class="c1"># number of lags, int</span>
        <span class="s1">&#39;ixd&#39;</span>    <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>     <span class="c1"># direction x</span>
        <span class="s1">&#39;iyd&#39;</span>    <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>     <span class="c1"># direction y</span>
        <span class="s1">&#39;izd&#39;</span>    <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>     <span class="c1"># direction z</span>
        <span class="s1">&#39;isill&#39;</span>  <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>         <span class="c1"># standardize sills? (0=no, 1=yes), int</span>
        <span class="s1">&#39;sills&#39;</span>  <span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span><span class="c1"># variance used to std the sills, array(&#39;f&#39;) with bounds (nv)</span>
        <span class="s1">&#39;ivtail&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="c1"># tail var., array(&#39;i&#39;) with bounds (nvarg), nvarg is number of variograms</span>
        <span class="s1">&#39;ivhead&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="c1"># head var., array(&#39;i&#39;) with bounds (nvarg)</span>
        <span class="s1">&#39;ivtype&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]}</span> <span class="c1"># variogram type, array(&#39;i&#39;) with bounds (nvarg)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>pdis</strong> (<em>Distance of pairs falling into this lag</em>)</li>
<li><strong>pgam</strong> (<em>Semivariogram, covariance, correlogram,... value</em>)</li>
<li><strong>phm</strong> (<em>Mean of the tail data</em>)</li>
<li><strong>ptm</strong> (<em>Mean of the head data</em>)</li>
<li><strong>phv</strong> (<em>Variance of the tail data</em>)</li>
<li><strong>ptv</strong> (<em>Variance of the head data</em>)</li>
<li><strong>pnump</strong> (<em>Number of pairs</em>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>For two variables use flatten array with order F, for example:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">vr</span><span class="o">=</span><span class="n">mydata</span><span class="p">[[</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;FORTRAN&#39;</span><span class="p">)</span>
<span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;vr&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">vr</span>
</pre></div>
</div>
</div>
<p>The output is a tuple of numpy 3D ndarrays (pdis,pgam, phm,ptm,phv,
ptv,pnump) with dimensions (nvarg, ndir, nlag+2), representing the
experimental variograms output.</p>
<p>The output is similar to the one generated by the
GSLIB standalone program <cite>gam</cite>.</p>
</dd></dl>

<dl class="function">
<dt id="pygslib.gslib.gamv">
<code class="descclassname">pygslib.gslib.</code><code class="descname">gamv</code><span class="sig-paren">(</span><em>parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.gslib.gamv" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate experimental variograms on sparse data</p>
<p>This function is similar to the GSLIB gamv function but with some minor differences:</p>
<blockquote>
<div><ul class="simple">
<li>the indicator automatic transformation is not applied; you may define
indicator variables externally.</li>
<li>a bhid variable is always required, to avoid downhole variogram use
<code class="docutils literal"><span class="pre">bhid=None</span></code> or <code class="docutils literal"><span class="pre">bhid</span> <span class="pre">=</span> <span class="pre">0</span></code>.</li>
<li>Z variable is required, you can use constant coordinate to reduce
dimensions, for example use Z=None in the parameter file or
Z = 0 in the file.</li>
<li>The variogram cloud was implemented but it only works for the first
variogram and first direction. It only works for some variogram types.</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parameters</strong> (<em>dict</em>) &#8211; dictionary with calculation parameters</td>
</tr>
</tbody>
</table>
<p>The dictionary with parameters may be as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span>      <span class="p">:</span>  <span class="n">X</span><span class="p">,</span>             <span class="c1"># X coordinates, array(&#39;f&#39;) with bounds (nd), nd is number of data points</span>
        <span class="s1">&#39;y&#39;</span>      <span class="p">:</span>  <span class="n">Y</span><span class="p">,</span>             <span class="c1"># Y coordinates, array(&#39;f&#39;) with bounds (nd)</span>
        <span class="s1">&#39;z&#39;</span>      <span class="p">:</span>  <span class="n">Z</span><span class="p">,</span>             <span class="c1"># Z coordinates, array(&#39;f&#39;) with bounds (nd)</span>
        <span class="s1">&#39;bhid&#39;</span>   <span class="p">:</span>  <span class="n">bhid</span><span class="p">,</span>          <span class="c1"># bhid for downhole variogram, array(&#39;i&#39;) with bounds (nd)</span>
        <span class="s1">&#39;vr&#39;</span>     <span class="p">:</span>  <span class="n">VR</span><span class="p">,</span>            <span class="c1"># Variables, array(&#39;f&#39;) with bounds (nd,nv), nv is number of variables</span>
        <span class="s1">&#39;tmin&#39;</span>   <span class="p">:</span> <span class="o">-</span><span class="mf">1.0e21</span><span class="p">,</span>        <span class="c1"># trimming limits, float</span>
        <span class="s1">&#39;tmax&#39;</span>   <span class="p">:</span>  <span class="mf">1.0e21</span><span class="p">,</span>        <span class="c1"># trimming limits, float</span>
        <span class="s1">&#39;nlag&#39;</span>   <span class="p">:</span>  <span class="mi">10</span><span class="p">,</span>            <span class="c1"># number of lags, int</span>
        <span class="s1">&#39;xlag&#39;</span>   <span class="p">:</span>  <span class="mi">4</span><span class="p">,</span>             <span class="c1"># lag separation distance, float</span>
        <span class="s1">&#39;xltol&#39;</span>  <span class="p">:</span>  <span class="mi">2</span><span class="p">,</span>             <span class="c1"># lag tolerance, float</span>
        <span class="s1">&#39;azm&#39;</span>    <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span>       <span class="c1"># azimuth, array(&#39;f&#39;) with bounds (ndir)</span>
        <span class="s1">&#39;atol&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span><span class="mf">22.5</span><span class="p">,</span><span class="mf">22.5</span><span class="p">],</span> <span class="c1"># azimuth tolerance, array(&#39;f&#39;) with bounds (ndir)</span>
        <span class="s1">&#39;bandwh&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>     <span class="c1"># bandwidth &#39;horizontal&#39;, array(&#39;f&#39;) with bounds (ndir)</span>
        <span class="s1">&#39;dip&#39;</span>    <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>        <span class="c1"># dip, array(&#39;f&#39;) with bounds (ndir)</span>
        <span class="s1">&#39;dtol&#39;</span>   <span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>     <span class="c1"># dip tolerance, array(&#39;f&#39;) with bounds (ndir)</span>
        <span class="s1">&#39;bandwd&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>     <span class="c1"># bandwidth &#39;vertical&#39;, array(&#39;f&#39;) with bounds (ndir)</span>
        <span class="s1">&#39;isill&#39;</span>  <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>              <span class="c1"># standardize sills? (0=no, 1=yes), int</span>
        <span class="s1">&#39;sills&#39;</span>  <span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">],</span>          <span class="c1"># variance used to std the sills, array(&#39;f&#39;) with bounds (nv)</span>
        <span class="s1">&#39;ivtail&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="c1"># tail var., array(&#39;i&#39;) with bounds (nvarg), nvarg is number of variograms</span>
        <span class="s1">&#39;ivhead&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="c1"># head var., array(&#39;i&#39;) with bounds (nvarg)</span>
        <span class="s1">&#39;ivtype&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="c1"># variogram type, array(&#39;i&#39;) with bounds (nvarg)</span>
        <span class="s1">&#39;maxclp&#39;</span> <span class="p">:</span> <span class="mi">50000</span><span class="p">}</span>          <span class="c1"># maximum number of variogram point cloud to use, input int</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">bhid must be an integer</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>pdis</strong> (<em>Distance of pairs falling into this lag</em>)</li>
<li><strong>pgam</strong> (<em>Semivariogram, covariance, correlogram,... value</em>)</li>
<li><strong>phm</strong> (<em>Mean of the tail data</em>)</li>
<li><strong>ptm</strong> (<em>Mean of the head data</em>)</li>
<li><strong>phv</strong> (<em>Variance of the tail data</em>)</li>
<li><strong>ptv</strong> (<em>Variance of the head data</em>)</li>
<li><strong>pnump</strong> (<em>Number of pairs</em>)</li>
<li><strong>cldi</strong> (<em>data index of the head</em>)</li>
<li><strong>cldj</strong> (<em>data index of the tail</em>)</li>
<li><strong>cldg</strong> (<em>Semivariogram, covariance, ... value</em>)</li>
<li><strong>cldh</strong> (<em>Distance of each pair</em>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The output variables with prefix <em>cld</em> are for variogram cloud and
with prefix <em>p</em> are for directional variograms</p>
<p>The variables with prefix <em>p</em> are similar to the output generated
by the GSLIB standalone program <strong>gamv</strong>.</p>
<p>The variogram cloud only works for the first variogram/direction
and only if the variogram of type 1, 2, 6, 7 and 8.</p>
<p>The variogram types are:</p>
<blockquote class="last">
<div><ul class="simple">
<li>traditional semivariogram (1)</li>
<li>traditional cross semivariogram (2)</li>
<li>pairwise relative semivariogram (6)</li>
<li>semivariogram of logarithms (7)</li>
<li>semimadogram(8)</li>
</ul>
</div></blockquote>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.gslib.kt3d">
<code class="descclassname">pygslib.gslib.</code><code class="descname">kt3d</code><span class="sig-paren">(</span><em>parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.gslib.kt3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates with the GSLIB program KT3D</p>
<p>This is a wrap for the GSLIB Fortran code of the program KT3D Version 2.0,
originally in Fortran 77. Only minor changes were included, the most
relevant are:</p>
<blockquote>
<div><ul class="simple">
<li>support for maximum number of samples per drillhole was
implemented</li>
<li>the direct file output was redirected to numpy arrays</li>
<li>the input (for grid estimate) is now as numpy arrays.
The grid definition was retained because is an input
of the GSLIB search super-block algorithm.</li>
<li>the trimming limits were removed; you may filter out
undesired values before estimating</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parameters</strong> (<em>dict</em>) &#8211; dictionary with calculation parameters</td>
</tr>
</tbody>
</table>
<p>The dictionary with parameters may be as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">kt3d_parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># Input Data</span>
    <span class="c1"># ----------</span>
    <span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># rank-1 array(&#39;f&#39;) with bounds (nd)</span>
    <span class="s1">&#39;y&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) rank-1 array(&#39;f&#39;) with bounds (nd)</span>
    <span class="s1">&#39;z&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) rank-1 array(&#39;f&#39;) with bounds (nd)</span>
    <span class="s1">&#39;vr&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) rank-1 array(&#39;f&#39;) with bounds (nd)</span>
    <span class="s1">&#39;ve&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) rank-1 array(&#39;f&#39;) with bounds (nd)</span>
    <span class="s1">&#39;bhid&#39;</span><span class="p">:</span> <span class="p">,</span> <span class="c1">#  (optional) rank-1 array(&#39;i&#39;) with bounds (nd)</span>
    <span class="c1"># Output (Target)</span>
    <span class="c1"># ----------</span>
    <span class="s1">&#39;nx&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># int</span>
    <span class="s1">&#39;ny&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># int</span>
    <span class="s1">&#39;nz&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># int</span>
    <span class="s1">&#39;xmn&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># float</span>
    <span class="s1">&#39;ymn&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># float</span>
    <span class="s1">&#39;zmn&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># float</span>
    <span class="s1">&#39;xsiz&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># float</span>
    <span class="s1">&#39;ysiz&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># float</span>
    <span class="s1">&#39;zsiz&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># float</span>
    <span class="s1">&#39;nxdis&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># int</span>
    <span class="s1">&#39;nydis&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># int</span>
    <span class="s1">&#39;nzdis&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># int</span>
    <span class="s1">&#39;outx&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># rank-1 array(&#39;f&#39;) with bounds (nout)</span>
    <span class="s1">&#39;outy&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) rank-1 array(&#39;f&#39;) with bounds (nout)</span>
    <span class="s1">&#39;outz&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) rank-1 array(&#39;f&#39;) with bounds (nout)</span>
    <span class="s1">&#39;outextve&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) rank-1 array(&#39;f&#39;) with bounds (nout)</span>
    <span class="c1"># Search parameters</span>
    <span class="c1"># ----------</span>
    <span class="s1">&#39;radius&#39;</span>     <span class="p">:</span> <span class="p">,</span>   <span class="c1"># float</span>
    <span class="s1">&#39;radius1&#39;</span>    <span class="p">:</span> <span class="p">,</span>   <span class="c1"># float</span>
    <span class="s1">&#39;radius2&#39;</span>    <span class="p">:</span> <span class="p">,</span>   <span class="c1"># float</span>
    <span class="s1">&#39;ndmax&#39;</span>      <span class="p">:</span> <span class="p">,</span>   <span class="c1"># int</span>
    <span class="s1">&#39;ndmin&#39;</span>      <span class="p">:</span> <span class="p">,</span>   <span class="c1"># int</span>
    <span class="s1">&#39;noct&#39;</span>       <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) int</span>
    <span class="s1">&#39;nbhid&#39;</span>       <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) int</span>
    <span class="s1">&#39;sang1&#39;</span>      <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) float</span>
    <span class="s1">&#39;sang2&#39;</span>      <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) float</span>
    <span class="s1">&#39;sang3&#39;</span>      <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) float</span>
    <span class="c1"># Kriging parameters and options</span>
    <span class="c1"># ----------</span>
    <span class="s1">&#39;idrif&#39;</span>      <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) rank-1 array(&#39;i&#39;) with bounds (9)</span>
    <span class="s1">&#39;itrend&#39;</span>     <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) int</span>
    <span class="s1">&#39;ktype&#39;</span>      <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) int</span>
    <span class="s1">&#39;skmean&#39;</span>     <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) float</span>
    <span class="s1">&#39;koption&#39;</span>    <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) int</span>
    <span class="s1">&#39;iktype&#39;</span>     <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) int</span>
    <span class="s1">&#39;cut&#39;</span>        <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) rank-1 array(&#39;f&#39;) with bounds (ncut)</span>
    <span class="s1">&#39;idbg&#39;</span>       <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) int</span>
    <span class="c1"># Variogram parameters</span>
    <span class="c1"># ----------</span>
    <span class="s1">&#39;c0&#39;</span>         <span class="p">:</span> <span class="p">,</span>   <span class="c1"># float</span>
    <span class="s1">&#39;it&#39;</span>         <span class="p">:</span> <span class="p">,</span>   <span class="c1"># rank-1 array(&#39;i&#39;) with bounds (nst)</span>
    <span class="s1">&#39;cc&#39;</span>         <span class="p">:</span> <span class="p">,</span>   <span class="c1"># rank-1 array(&#39;f&#39;) with bounds (nst)</span>
    <span class="s1">&#39;aa&#39;</span>         <span class="p">:</span> <span class="p">,</span>   <span class="c1"># rank-1 array(&#39;f&#39;) with bounds (nst)</span>
    <span class="s1">&#39;aa1&#39;</span>        <span class="p">:</span> <span class="p">,</span>   <span class="c1"># rank-1 array(&#39;f&#39;) with bounds (nst)</span>
    <span class="s1">&#39;aa2&#39;</span>        <span class="p">:</span> <span class="p">,</span>   <span class="c1"># rank-1 array(&#39;f&#39;) with bounds (nst)</span>
    <span class="s1">&#39;ang1&#39;</span>       <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) rank-1 array(&#39;f&#39;) with bounds (nst)</span>
    <span class="s1">&#39;ang2&#39;</span>       <span class="p">:</span> <span class="p">,</span>   <span class="c1"># (optional) rank-1 array(&#39;f&#39;) with bounds (nst)</span>
    <span class="s1">&#39;ang3&#39;</span>       <span class="p">:</span> <span class="p">}</span>   <span class="c1"># (optional) rank-1 array(&#39;f&#39;) with bounds (nst)</span>
</pre></div>
</div>
<p>The optional input will be internally initialized to zero or to
array of zeros.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>output</strong> (<em>dict, estimation results at target points/blocks</em>)</li>
<li><strong>debug</strong> (<em>debug output for the last block estimated</em>)</li>
<li><strong>estimate</strong> (<em>estimation summary</em>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The estimation results <code class="docutils literal"><span class="pre">output</span></code> will be as follows:</p>
<p>If iktype=0 returns variable estimate as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;outest&#39;</span>    <span class="p">:</span> <span class="p">,</span>  <span class="c1">#rank-1 array(&#39;f&#39;) with bounds (nout)</span>
<span class="s1">&#39;outkvar&#39;</span>    <span class="p">:</span> <span class="p">}</span>  <span class="c1">#rank-1 array(&#39;f&#39;) with bounds (nout)</span>
</pre></div>
</div>
<p>If ktype=1 returns median kriging estimate as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;outcdf&#39;</span>     <span class="p">:</span> <span class="p">}</span>  <span class="c1">#rank-2 array(&#39;f&#39;) with bounds (nout,ncut)</span>
</pre></div>
</div>
<p>The debug output <code class="docutils literal"><span class="pre">debug</span></code> will be only for the last block estimated
but calculated for all the blocks. Make sure to set <code class="docutils literal"><span class="pre">idbg</span></code>
to zero for estimation in large models.</p>
<p>If idbg = 0 <code class="docutils literal"><span class="pre">debug</span></code> will be an empty dictionary.
If debug &gt; 0 <code class="docutils literal"><span class="pre">debug</span></code> will be as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;cbb&#39;</span>       <span class="p">:</span> <span class="p">,</span>  <span class="c1">#float</span>
<span class="s1">&#39;neq&#39;</span>        <span class="p">:</span> <span class="p">,</span>  <span class="c1">#int</span>
<span class="s1">&#39;na&#39;</span>         <span class="p">:</span> <span class="p">,</span>  <span class="c1">#int</span>
<span class="s1">&#39;dbgxdat&#39;</span>    <span class="p">:</span> <span class="p">,</span>  <span class="c1">#rank-1 array(&#39;f&#39;) with bounds (ndmax)</span>
<span class="s1">&#39;dbgydat&#39;</span>    <span class="p">:</span> <span class="p">,</span>  <span class="c1">#rank-1 array(&#39;f&#39;) with bounds (ndmax)</span>
<span class="s1">&#39;dbgzdat&#39;</span>    <span class="p">:</span> <span class="p">,</span>  <span class="c1">#rank-1 array(&#39;f&#39;) with bounds (ndmax)</span>
<span class="s1">&#39;dbgvrdat&#39;</span>   <span class="p">:</span> <span class="p">,</span>  <span class="c1">#rank-1 array(&#39;f&#39;) with bounds (ndmax)</span>
<span class="s1">&#39;dbgwt&#39;</span>      <span class="p">:</span> <span class="p">,</span>  <span class="c1">#rank-1 array(&#39;f&#39;) with bounds (ndmax + 11)</span>
<span class="s1">&#39;dbgxtg&#39;</span>     <span class="p">:</span> <span class="p">,</span>  <span class="c1">#float</span>
<span class="s1">&#39;dbgytg&#39;</span>     <span class="p">:</span> <span class="p">,</span>  <span class="c1">#float</span>
<span class="s1">&#39;dbgztg&#39;</span>     <span class="p">:</span> <span class="p">,</span>  <span class="c1">#float</span>
<span class="s1">&#39;dbgkvector&#39;</span> <span class="p">:</span> <span class="p">,</span>  <span class="c1">#rank-1 array(&#39;f&#39;) with bounds (ndmax + 11)</span>
<span class="s1">&#39;dbgkmatrix&#39;</span> <span class="p">:</span> <span class="p">,</span>
<span class="s1">&#39;ellipsoid&#39;</span>  <span class="p">:</span>  <span class="p">}</span> <span class="c1">#vtkpolydata object with ellipsoid</span>
</pre></div>
</div>
<p>The output <code class="docutils literal"><span class="pre">estimate</span></code> is to provide an estimation summary
but this is not implemented yet.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Not all the parameters are used for calculation, it depends on the
kriging type and options</p>
<p>Optional parameters can be removed, knowing that kt3D will create
internal arrays/variable initialized to zero value</p>
<p>If using nbhid &gt; 0 the hole id number (bhid) is required. Hole
IDs may be integers from one to total number of drillholes.
Use function pygslib.Drillhole.txt2intID(table_name) to get
a correct bhid number.</p>
<p class="last">Some important stats and run progress are only available in the
stdout (the terminal) and will not be available in Ipython Notebooks.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.gslib.postik">
<code class="descclassname">pygslib.gslib.</code><code class="descname">postik</code><span class="sig-paren">(</span><em>parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.gslib.postik" title="Permalink to this definition">¶</a></dt>
<dd><p>Postprocess indicator kriging output (cdf)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parameters</strong> (<em>dict</em>) &#8211; dictionary with calculation parameters</td>
</tr>
</tbody>
</table>
<p>The dictionary with parameters may be as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">postik_parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># output option, output parameter</span>
    <span class="s1">&#39;iout&#39;</span>   <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input int. Possible (1,2,3 or 4)</span>
    <span class="s1">&#39;voutpar&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input float</span>
    <span class="c1"># the thresholds</span>
    <span class="s1">&#39;ccut1&#39;</span>  <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input rank-1 array(&#39;f&#39;) with bounds (nccut)</span>
    <span class="c1"># volume support?, type, varred</span>
    <span class="s1">&#39;ivol&#39;</span>   <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input int</span>
    <span class="s1">&#39;ivtyp&#39;</span>  <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input int</span>
    <span class="s1">&#39;varred&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input float</span>
    <span class="c1"># minimum and maximum Z value</span>
    <span class="s1">&#39;zmin&#39;</span>   <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input float</span>
    <span class="s1">&#39;zmax&#39;</span>   <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input float</span>
    <span class="c1"># lower,middle and upper tail: option, parameter</span>
    <span class="s1">&#39;ltail&#39;</span>  <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input int</span>
    <span class="s1">&#39;ltpar&#39;</span>  <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input float</span>
    <span class="s1">&#39;middle&#39;</span>  <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input int</span>
    <span class="s1">&#39;mpar&#39;</span>  <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input float</span>
    <span class="s1">&#39;utail&#39;</span>  <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input int</span>
    <span class="s1">&#39;utpar&#39;</span>  <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input float</span>
    <span class="c1"># maximum discretization</span>
    <span class="s1">&#39;maxdis&#39;</span> <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input int</span>
    <span class="c1"># 1D arrays with global distribution</span>
    <span class="s1">&#39;vr&#39;</span>     <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input rank-1 array(&#39;f&#39;) with bounds (nc)</span>
    <span class="s1">&#39;wt&#39;</span>     <span class="p">:</span> <span class="p">,</span>   <span class="c1"># input rank-1 array(&#39;f&#39;) with bounds (nc)</span>
    <span class="c1"># 2D array with IK3D output (continuous)</span>
    <span class="s1">&#39;p&#39;</span>      <span class="p">:</span> <span class="p">}</span>   <span class="c1"># input rank-2 array(&#39;f&#39;) with bounds (na,nc)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>out1</strong> (<em>rank-1 array(&#8216;f&#8217;) with bounds (na)</em>)</li>
<li><strong>out2</strong> (<em>rank-1 array(&#8216;f&#8217;) with bounds (na)</em>)</li>
<li><strong>out3</strong> (<em>rank-1 array(&#8216;f&#8217;) with bounds (na)</em>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>If <code class="docutils literal"><span class="pre">iout</span> <span class="pre">==</span> <span class="pre">1</span></code> (E-Type estimate) <code class="docutils literal"><span class="pre">out1</span></code> will be the E-Type
estimate. <code class="docutils literal"><span class="pre">out2</span></code> and <code class="docutils literal"><span class="pre">out3</span></code> will be NaN</p>
<p>If <code class="docutils literal"><span class="pre">iout</span> <span class="pre">==</span> <span class="pre">2</span></code> (prob &gt; cutoff) <code class="docutils literal"><span class="pre">out1</span></code> will be the probability
above the cutoff, <code class="docutils literal"><span class="pre">out2</span></code> the mean above the cutoff and <code class="docutils literal"><span class="pre">out3</span></code>
the mean below the cutoff</p>
<p>If <code class="docutils literal"><span class="pre">iout</span> <span class="pre">==</span> <span class="pre">3</span></code> (p-quantile estimate) <code class="docutils literal"><span class="pre">out1</span></code> will be the
Z value corresponding to the CDF == p. <code class="docutils literal"><span class="pre">out2</span></code> and <code class="docutils literal"><span class="pre">out3</span></code> will be
NaN</p>
<p>If <code class="docutils literal"><span class="pre">iout</span> <span class="pre">==</span> <span class="pre">4</span></code> (conditional variance) <code class="docutils literal"><span class="pre">out1</span></code> will be the
conditional variance. <code class="docutils literal"><span class="pre">out2</span></code> and <code class="docutils literal"><span class="pre">out3</span></code> will be NaN</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="docutils literal"><span class="pre">iout</span></code> options are:</p>
<blockquote class="last">
<div>1 = E-type
2 = probability and mean above <code class="docutils literal"><span class="pre">voutpar</span></code> (e.j. cutoff value)
3 = Z percentile corresponding to a probability <code class="docutils literal"><span class="pre">voutpar</span></code>
4 = conditional variance</div></blockquote>
</div>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>    <span class="n">out1</span><span class="p">,</span><span class="n">out2</span><span class="p">,</span><span class="n">out3</span><span class="p">,</span><span class="n">error</span> <span class="o">=</span> <span class="n">postik</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.gslib.read_gslib_file">
<code class="descclassname">pygslib.gslib.</code><code class="descname">read_gslib_file</code><span class="sig-paren">(</span><em>fname</em>, <em>maxnvar=500</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.gslib.read_gslib_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a gslib file</p>
<p>The native Fortran code is used to read GEOEAS (gslib) files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fname</strong> (<em>str</em>) &#8211; file name path (absolute or relative)</li>
<li><strong>maxnvar</strong> (<em>Optional[int]</em>) &#8211; maximum number of variables in file</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>data</strong> &#8211; The file is returned in memory as a Pandas DataFrame</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Pandas DataFrame</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pygslib</span> <span class="k">as</span> <span class="nn">gslib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydata</span><span class="o">=</span> <span class="n">gslib</span><span class="o">.</span><span class="n">gslib</span><span class="o">.</span><span class="n">read_gslib_file</span><span class="p">(</span><span class="s1">&#39;dataset/cluster.dat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">mydata</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">          Xlocation  Ylocation  Primary  Secondary  Declustering Weight</span>
<span class="go">    0       39.5       18.5     0.06       0.22                1.619</span>
<span class="go">    1        5.5        1.5     0.06       0.27                1.619</span>
<span class="go">    2       38.5        5.5     0.08       0.40                1.416</span>
<span class="go">    3       20.5        1.5     0.09       0.39                1.821</span>
<span class="go">    4       27.5       14.5     0.09       0.24                1.349</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.gslib.rotcoord">
<code class="descclassname">pygslib.gslib.</code><code class="descname">rotcoord</code><span class="sig-paren">(</span><em>ang1=0</em>, <em>ang2=0</em>, <em>ang3=0</em>, <em>anis1=1</em>, <em>anis2=1</em>, <em>ind=1</em>, <em>invert=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.gslib.rotcoord" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates rotation matrix</p>
<p>This is the rotation matrix used internally in standard
GSLIB programs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ang1</strong> (<em>input float, Azimuth angle  (rotation along Z)</em>) &#8211; </li>
<li><strong>ang2</strong> (<em>input float, Dip angle (downdip positive) (rotation along X)</em>) &#8211; </li>
<li><strong>ang3</strong> (<em>input float, Plunge angle   (rotation along Z)</em>) &#8211; </li>
<li><strong>anis1</strong> (<em>input float, First anisotropy ratio (semi mayor direction/mayor direction)</em>) &#8211; </li>
<li><strong>anis2</strong> (<em>input float, Second anisotropy ratio (minor direction/mayor direction)</em>) &#8211; </li>
<li><strong>ind</strong> (<em>input int, index</em>) &#8211; </li>
<li><strong>maxrot</strong> (<em>input int, number of matrices (for example use 3 for a ZXZ, rotation)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>rotmat</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">rank-3 array(&#8216;d&#8217;) with bounds (maxrot,3,3)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pygslib.gslib.rotscale">
<code class="descclassname">pygslib.gslib.</code><code class="descname">rotscale</code><span class="sig-paren">(</span><em>parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.gslib.rotscale" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates and rescales a set of 3D coordinates</p>
<p>The new rotated and rescaled system of coordinates will have
origin at [x = 0, y = 0, z = 0]. This point corresponds to
[x0,y0,z0] (the pivot point) in the original system of coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parameters</strong> (<em>dict</em>) &#8211; dictionary with calculation parameters</td>
</tr>
</tbody>
</table>
<p>Parameters are pased in a dictionary as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span>      <span class="p">:</span>  <span class="n">mydata</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="c1"># data x coordinates, array(&#39;f&#39;) with bounds (na), na is number of data points</span>
        <span class="s1">&#39;y&#39;</span>      <span class="p">:</span>  <span class="n">mydata</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="c1"># data y coordinates, array(&#39;f&#39;) with bounds (na)</span>
        <span class="s1">&#39;z&#39;</span>      <span class="p">:</span>  <span class="n">mydata</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="c1"># data z coordinates, array(&#39;f&#39;) with bounds (na)</span>
        <span class="s1">&#39;x0&#39;</span>     <span class="p">:</span>  <span class="mi">0</span><span class="p">,</span>       <span class="c1"># pivot point coordinate X, &#39;f&#39;</span>
        <span class="s1">&#39;y0&#39;</span>     <span class="p">:</span>  <span class="mi">0</span><span class="p">,</span>       <span class="c1"># pivot point coordinate Y, &#39;f&#39;</span>
        <span class="s1">&#39;z0&#39;</span>     <span class="p">:</span>  <span class="mi">0</span><span class="p">,</span>       <span class="c1"># pivot point coordinate Z, &#39;f&#39;</span>
        <span class="s1">&#39;ang1&#39;</span>   <span class="p">:</span>  <span class="mf">45.</span><span class="p">,</span>     <span class="c1"># Z  Rotation angle, &#39;f&#39;</span>
        <span class="s1">&#39;ang2&#39;</span>   <span class="p">:</span>  <span class="mf">0.</span><span class="p">,</span>      <span class="c1"># X  Rotation angle, &#39;f&#39;</span>
        <span class="s1">&#39;ang3&#39;</span>   <span class="p">:</span>  <span class="mf">0.</span><span class="p">,</span>      <span class="c1"># Y  Rotation angle, &#39;f&#39;</span>
        <span class="s1">&#39;anis1&#39;</span>  <span class="p">:</span>  <span class="mf">1.</span><span class="p">,</span>      <span class="c1"># Y cell anisotropy, &#39;f&#39;</span>
        <span class="s1">&#39;anis2&#39;</span>  <span class="p">:</span>  <span class="mf">1.</span><span class="p">,</span>      <span class="c1"># Z cell anisotropy, &#39;f&#39;</span>
        <span class="s1">&#39;invert&#39;</span> <span class="p">:</span>  <span class="mi">0</span><span class="p">}</span>       <span class="c1"># 0 do rotation, &lt;&gt; 0 invert rotation, &#39;i&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>xr</strong> (<em>rank-1 array(&#8216;d&#8217;) with bounds (nd), new X coordinate</em>)</li>
<li><strong>yr</strong> (<em>rank-1 array(&#8216;d&#8217;) with bounds (nd), new X coordinate</em>)</li>
<li><strong>zr</strong> (<em>rank-1 array(&#8216;d&#8217;) with bounds (nd), new X coordinate</em>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This is nonstandard gslib function and is based on the paper:</p>
<blockquote>
<div><a class="reference external" href="http://www.ccgalberta.com/ccgresources/report06/2004-403-angle_rotations.pdf">http://www.ccgalberta.com/ccgresources/report06/2004-403-angle_rotations.pdf</a></div></blockquote>
<p class="last">The rotation is  {Z counter clockwise ; X clockwise; Y counter clockwise} [-ZX-Y]</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.gslib.set_nan_value">
<code class="descclassname">pygslib.gslib.</code><code class="descname">set_nan_value</code><span class="sig-paren">(</span><em>value=nan</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.gslib.set_nan_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Set non-estimated value in the modules KT3D and POSTIK</p>
<p>This will change the value assigned to non-estimated values</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<em>numeric (optional, default np.nan)</em>) &#8211; </td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This will change the behavior of KT3D in the actual python section.</p>
</div>
<p>to see the actual non-estimated value you may call <code class="docutils literal"><span class="pre">__gslib__kt3d.UNEST</span></code></p>
</dd></dl>

<dl class="function">
<dt id="pygslib.gslib.setrot">
<code class="descclassname">pygslib.gslib.</code><code class="descname">setrot</code><span class="sig-paren">(</span><em>ang1=0</em>, <em>ang2=0</em>, <em>ang3=0</em>, <em>anis1=1</em>, <em>anis2=1</em>, <em>ind=1</em>, <em>maxrot=1</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.gslib.setrot" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates a rotation and scaling matrix given a set of angles</p>
<p>This is necessary for some interval GSLIB function (ex. cova3)</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The rotations are peculiar, do not use this to rotate data.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ang1</strong> (<em>input float, Azimuth angle  (rotation along Z)</em>) &#8211; </li>
<li><strong>ang2</strong> (<em>input float, Dip angle (downdip positive) (rotation along X)</em>) &#8211; </li>
<li><strong>ang3</strong> (<em>input float, Plunge angle   (rotation along Z)</em>) &#8211; </li>
<li><strong>anis1</strong> (<em>input float, First anisotropy ratio (semi mayor direction/mayor direction)</em>) &#8211; </li>
<li><strong>anis2</strong> (<em>input float, Second anisotropy ratio (minor direction/mayor direction)</em>) &#8211; </li>
<li><strong>ind</strong> (<em>input int, index</em>) &#8211; </li>
<li><strong>maxrot</strong> (<em>input int, number of matrices (for example use 3 for a ZXZ, rotation)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>rotmat</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">rank-3 array(&#8216;d&#8217;) with bounds (maxrot,3,3)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pygslib.drillhole">
<span id="pygslib-drillhole"></span><h2>PyGSLIB.drillhole<a class="headerlink" href="#module-pygslib.drillhole" title="Permalink to this headline">¶</a></h2>
<p>PyGSLIB Drillhole, Module to handle drillhole data, desurvey
interval tables and other drillhole relate processes.</p>
<p>Copyright (C) 2015 Adrian Martinez Vargas</p>
<p>This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 3 of the License, or
any later version.</p>
<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with this program.  If not, see &lt;<a class="reference external" href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;</p>
<dl class="class">
<dt id="pygslib.drillhole.Drillhole">
<em class="property">class </em><code class="descclassname">pygslib.drillhole.</code><code class="descname">Drillhole</code><a class="headerlink" href="#pygslib.drillhole.Drillhole" title="Permalink to this definition">¶</a></dt>
<dd><p>Drillhole object with functions to desurvey and
validate drillholes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>collar</strong> (<em>Pandas DataFrame</em>) &#8211; </li>
<li><strong>survey</strong> (<em>Pandas DataFrame</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span> <span class="o">=</span> <span class="n">pygslib</span><span class="o">.</span><span class="n">drillhole</span><span class="o">.</span><span class="n">Drillhole</span><span class="p">(</span><span class="n">collar</span><span class="p">,</span> <span class="n">survey</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">addtable</span><span class="p">(</span><span class="n">assay</span><span class="p">,</span> <span class="s1">&#39;assay&#39;</span> <span class="p">,</span><span class="n">overwrite</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>The collar table may contain the fields:</p>
<blockquote>
<div><ul class="simple">
<li>BHID with any dtype</li>
<li>XCOLLAR, YCOLLAR, ZCOLLAR with dtypes <cite>float64</cite>.</li>
<li>(Optional) LENGTH with dtypes <cite>float64</cite>. This is the length of
drillhole and can be used in some functions, for example,
to fill gaps.</li>
</ul>
</div></blockquote>
<p>The survey table may contain the fields:</p>
<blockquote>
<div><ul class="simple">
<li>BHID with any dtype</li>
<li>AT,AZ, DIP with dtypes <cite>float64</cite>.</li>
</ul>
</div></blockquote>
<dl class="attribute">
<dt id="pygslib.drillhole.Drillhole.collar">
<code class="descname">collar</code><a class="headerlink" href="#pygslib.drillhole.Drillhole.collar" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Pandas DataFrame</em> &#8211; The collar table</p>
</dd></dl>

<dl class="attribute">
<dt id="pygslib.drillhole.Drillhole.survey">
<code class="descname">survey</code><a class="headerlink" href="#pygslib.drillhole.Drillhole.survey" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Pandas DataFrame</em> &#8211; The survey table</p>
</dd></dl>

<dl class="attribute">
<dt id="pygslib.drillhole.Drillhole.tables">
<code class="descname">tables</code><a class="headerlink" href="#pygslib.drillhole.Drillhole.tables" title="Permalink to this definition">¶</a></dt>
<dd><p><em>[Pandas DataFrame]</em> &#8211; list with Pandas DataFrames with interval tables (e.j. assay)
containing compulsory fields: BHID with any dtype
and FROM, TO with dtypes <cite>float64</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="pygslib.drillhole.Drillhole.table_mames">
<code class="descname">table_mames</code><a class="headerlink" href="#pygslib.drillhole.Drillhole.table_mames" title="Permalink to this definition">¶</a></dt>
<dd><p><em>[str]</em> &#8211; list of table names</p>
</dd></dl>

<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>A new copy of the input data will be created in memory. To work with
shared memory in an external DataFrame you may copy back the table:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shared_collar</span> <span class="o">=</span> <span class="n">mydrillholeDB</span><span class="o">.</span><span class="n">collar</span>
</pre></div>
</div>
<ul class="last simple">
<li>To add interval tables use <code class="docutils literal"><span class="pre">addtable</span></code></li>
<li>The existence of compulsory fields is only validated during
object initialization and when adding interval tables</li>
<li>Survey tables may have at least 2 intervals and an interval AT=0
is required for desurvey</li>
</ul>
</div>
<dl class="method">
<dt id="pygslib.drillhole.Drillhole.add_gaps">
<code class="descname">add_gaps</code><span class="sig-paren">(</span><em>str table_name</em>, <em>str new_table_name</em>, <em>bint overwrite =False</em>, <em>double tol=0.01</em>, <em>bint endhole=False</em>, <em>bint clean=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.Drillhole.add_gaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills gaps with new FROM-TO intervals.</p>
<p>All the gaps, including the gaps at collar and at the end of
drillholes will be filled with <code class="docutils literal"><span class="pre">NaN</span></code> intervals.</p>
<p>A code field <code class="docutils literal"><span class="pre">_id0</span></code> will be added to new and existing tables.
<code class="docutils literal"><span class="pre">_id0</span></code> can be used to link input table rows with the output
table rows. Gaps will have <code class="docutils literal"><span class="pre">_id0=</span> <span class="pre">-999</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>table_name</strong> (<em>name of the table to add gaps</em>) &#8211; it must be an existing table at drillhole.table.keys()</li>
<li><strong>new_table_name</strong> (<em>name of the new table with gaps added</em>) &#8211; it can be a new name, no in drillhole.table.keys()
or a table name on drillhole.table.keys() if overwrite =True</li>
<li><strong>overwrite</strong> (<em>default True.</em>) &#8211; If the table exist and overwrite = True the existing table
will be overwrite.</li>
<li><strong>tol</strong> (<em>default 0.01.</em>) &#8211; gaps and overlays within tol will be ignore but adjusted
in order to impose FROM[i-1]==TO[i]</li>
<li><strong>endhole</strong> (<em>default False.</em>) &#8211; if true a gap at the end of the drillhole will be added.
The end of the drillhole is calculated from
drillhole.collar[&#8216;LENGTH&#8217;], and error will be raised if:
there is no &#8216;LENGTH&#8217; field at collar or if there are
undefined values at LENGTH. Warnings will be raised is the
TO  &gt; LENGTH.</li>
<li><strong>clean</strong> (<em>default True.</em>) &#8211; Delete temporary columns created with suffix __tmp__.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>gap,overlap</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gap</span><span class="p">,</span><span class="n">overlap</span><span class="o">=</span> <span class="n">mydrillhole</span><span class="o">.</span><span class="n">add_gaps</span><span class="p">(</span><span class="n">table_name</span> <span class="o">=</span> <span class="s1">&#39;assay&#39;</span><span class="p">,</span>
<span class="go">                                     new_table_name = &#39;tmp&#39;,</span>
<span class="go">                                     overwrite=False,</span>
<span class="go">                                     tol=0.01,</span>
<span class="go">                                     endhole=False,</span>
<span class="go">                                     clean=True)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The output <code class="docutils literal"><span class="pre">gap</span></code> and <code class="docutils literal"><span class="pre">overlap</span></code> contain <a href="#id1"><span class="problematic" id="id2">``</span></a>_id0` of the raws
before the gap or the overlap was detected.
Gaps and overlaps at the end of the drillhole
(if endhole==True) _id0 will have value -888.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.drillhole.Drillhole.addtable">
<code class="descname">addtable</code><span class="sig-paren">(</span><em>object table</em>, <em>str table_name</em>, <em>bint overwrite =False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.Drillhole.addtable" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a table and assigns a name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>table</strong> (<em>Pandas DataFrame</em>) &#8211; containing compulsory fields BHID with any dtype and
FROM, TO with dtypes float64.</li>
<li><strong>table_name</strong> (<em>str</em>) &#8211; with an the name of the table</li>
<li><strong>overwrite</strong> (<em>boolean, optional, default False</em>) &#8211; if the name of the table exists overwrite = True will
overwrite the existing table with the new input table</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">addtable</span><span class="p">(</span><span class="n">assay</span><span class="p">,</span> <span class="s1">&#39;assay&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.drillhole.Drillhole.bench_composite">
<code class="descname">bench_composite</code><span class="sig-paren">(</span><em>str table_name</em>, <em>double zmax</em>, <em>double bench</em>, <em>double tolerance=0.01</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.Drillhole.bench_composite" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is not implemented yet.</p>
</dd></dl>

<dl class="method">
<dt id="pygslib.drillhole.Drillhole.collar2table">
<code class="descname">collar2table</code><span class="sig-paren">(</span><em>str table_name</em>, <em>str new_table_name</em>, <em>list collar_prop</em>, <em>bint overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.Drillhole.collar2table" title="Permalink to this definition">¶</a></dt>
<dd><p>Add collar properties to a table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>table_name</strong> (<em>name of the table</em>) &#8211; </li>
<li><strong>new_table_name</strong> (<em>name of the output table</em>) &#8211; </li>
<li><strong>collar_prop</strong> (<em>list with property names in collar</em>) &#8211; the property names may exist at drillhole.collar.columns
if collar_prop= Null all the Collar properties will be copied</li>
<li><strong>overwrite</strong> (<em>default False</em>) &#8211; If new_table_name exists and overwrite == True the existing
table will be overwrite.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">collar2table</span><span class="p">(</span><span class="n">table_name</span> <span class="o">=</span> <span class="s1">&#39;assay&#39;</span><span class="p">,</span>
<span class="go">                             new_table_name = &#39;assay&#39;,</span>
<span class="go">                             collar_prop = [&#39;TYPE&#39;, &#39;COMMENT&#39;],</span>
<span class="go">                             overwrite = True)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.drillhole.Drillhole.del_table">
<code class="descname">del_table</code><span class="sig-paren">(</span><em>str table_name</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.Drillhole.del_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>table_name</strong> (<em>str</em>) &#8211; the name of the table</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">addtable</span><span class="p">(</span><span class="s1">&#39;assay&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.drillhole.Drillhole.desurvey">
<code class="descname">desurvey</code><span class="sig-paren">(</span><em>str table_name</em>, <em>bint endpoints=False</em>, <em>bint warns=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.Drillhole.desurvey" title="Permalink to this definition">¶</a></dt>
<dd><p>Desurvey a drillhole table.</p>
<p>Create coordinates and direction angles at table midpoint
intervals. If <code class="docutils literal"><span class="pre">endpoints=True</span></code> it also creates coordinate fields
at end point intervals. The existing coordinate fields will be
overwritten.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>table_name</strong> (<em>str</em>) &#8211; </li>
<li><strong>endpoints</strong> (<em>boolean</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># sort with pandas function DataFrame.sort</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">collar</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="s1">&#39;BHID&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">survey</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="s1">&#39;BHID&#39;</span><span class="p">,</span> <span class="s1">&#39;AT&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;assay&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="s1">&#39;BHID&#39;</span><span class="p">,</span> <span class="s1">&#39;FROM&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># desurvey</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">desurvey</span><span class="p">(</span><span class="s1">&#39;assay&#39;</span><span class="p">,</span> <span class="n">endpoints</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><cite>collar</cite>, <cite>survey</cite> and the input table may be sorted.
If you call the function with <cite>endpoints=False</cite> end points already
desurveyed may not be overwritten.</p>
<p class="last">This function calls dsmincurb() and desurv1dh() functions to
calculate the desurvey value.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.drillhole.Drillhole.downh_composite">
<code class="descname">downh_composite</code><span class="sig-paren">(</span><em>str table_name</em>, <em>str variable_name</em>, <em>str new_table_name</em>, <em>double cint = 1</em>, <em>double minlen=-1</em>, <em>bint overwrite =False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.Drillhole.downh_composite" title="Permalink to this definition">¶</a></dt>
<dd><p>Downhole composites one variable at the time</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>table_name</strong> (<em>name of the table with drillhole intervals</em>) &#8211; it must be an existing table at drillhole.table.keys()</li>
<li><strong>variable_name</strong> (<em>name of the variable in &quot;table_name&quot; table</em>) &#8211; it must be an existing table at drillhole.table[table_name].columns</li>
<li><strong>new_table_name</strong> (<em>name of the new table with composites</em>) &#8211; it can be a new name, no in drillhole.table.keys()
or a table name on drillhole.table.keys() if overwrite =True</li>
<li><strong>cint</strong> (<em>default 1, compositing interval length</em>) &#8211; it may be greater than zero</li>
<li><strong>minlen</strong> (<em>default -1 minimum composite length</em>) &#8211; if &lt; 0 then minlen will be cint/2.</li>
<li><strong>overwrite</strong> (<em>default True.</em>) &#8211; If the table exist and overwrite = True the existing table
will be overwritten.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">downh_composite</span><span class="p">(</span><span class="n">table_name</span> <span class="o">=</span> <span class="s1">&#39;assay&#39;</span><span class="p">,</span>
<span class="go">                                variable_name = &#39;Au&#39;,</span>
<span class="go">                                new_table_name = &#39;cmp&#39;,</span>
<span class="go">                                cint = 1,</span>
<span class="go">                                minlen =-1,</span>
<span class="go">                                overwrite = False)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Undefined intervals in &#8216;variable_name&#8217; will be excluded.</p>
<p>To composite per lithology, you can filter out each lithology
composite and then combine the composite tables.</p>
<p>This algorithm starts from distance zero and no residual will
be created at the top, for example, the if the first interval is
[FROM=1.5, TO=2] it will be composited as [FROM=0, TO=2,_len=0.5]
for 2 m composites. This produce consistent results if different
tables are composited, making easier later table combination</p>
<p class="last">The accumulation output &#8216;_acum&#8217; can be used to produce accumulated
variables, to identify number of intervals in each composite or
to track categorical variables (coded as number) compositing.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.drillhole.Drillhole.export_core_vtk_line">
<code class="descname">export_core_vtk_line</code><span class="sig-paren">(</span><em>str table_name</em>, <em>str filename</em>, <em>double nanval=0</em>, <em>str title = ''</em>, <em>bint binary=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.Drillhole.export_core_vtk_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Export desurveyed drillhole table to vtk lines. Endpoints
are required.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>table_name</strong> (<em>str</em>) &#8211; </li>
<li><strong>filename</strong> (<em>str</em>) &#8211; This is the absolute or relative file path and name.</li>
<li><strong>title</strong> (<em>str</em>) &#8211; The file header (or title, or comment)</li>
<li><strong>nanval</strong> (<em>float</em>) &#8211; Numeric fields with nan values will be replaced with nanval</li>
<li><strong>binary</strong> (<em>boolean  (default True)</em>) &#8211; If true export data in binary format, otherwise the output
will be in ascii format</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">pygslib.vtktool()</span></code></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To export to VTK points see pygslib.vtktool</p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">export_core_vtk_line</span><span class="p">(</span><span class="n">table_name</span> <span class="o">=</span> <span class="s1">&#39;assay&#39;</span><span class="p">,</span>
<span class="go">                                    filename = &#39;assay_line.vtk&#39;</span>
<span class="go">                                    nanval=-999,</span>
<span class="go">                                    binary=True)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.drillhole.Drillhole.fix_survey_one_interval_err">
<code class="descname">fix_survey_one_interval_err</code><span class="sig-paren">(</span><em>self</em>, <em>double dummy_at</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.Drillhole.fix_survey_one_interval_err" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixes drillholes with a single survey record.</p>
<p>Drillholes may have at least two survey records. This function
adds a dummy survey record in drillholes with a single survey
interval at a position <code class="docutils literal"><span class="pre">dummy_at</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dummy_at</strong> (<em>float</em>) &#8211; this value will be used as a dummy <cite>AT</cite> value at survey</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">fix_survey_one_interval_err</span><span class="p">(</span><span class="n">dummy_at</span> <span class="o">=</span> <span class="mf">900.0</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The dummy records added are a duplicated of the unique record
available but with <code class="docutils literal"><span class="pre">AT</span> <span class="pre">=</span> <span class="pre">dummy_at</span></code>. The result will be a
straight drillhole.</p>
<p class="last">You will not be able to desurvey if there are drillholes with
only one survey record.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.drillhole.Drillhole.fix_zero_interval">
<code class="descname">fix_zero_interval</code><span class="sig-paren">(</span><em>str table_name</em>, <em>str new_table_name</em>, <em>bint overwrite = False</em>, <em>double tol = 0.01</em>, <em>bint clean = True</em>, <em>bint endhole=False</em>, <em>bint addgaps=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.Drillhole.fix_zero_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes zero length intervals</p>
<p>The function removes zero intervals and
adds gaps if the gap length is longer than the tolerance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>table_name</strong> (<em>name of the table</em>) &#8211; </li>
<li><strong>new_table_name</strong> (<em>name of the new table</em>) &#8211; it may not exists at drillhole.table.keys()</li>
<li><strong>overwrite</strong> (<em>default True.</em>) &#8211; If new_table_name exists and overwrite == True the existing
table will be overwritten.</li>
<li><strong>tol</strong> (<em>default 0.01.</em>) &#8211; segments with length&lt;= 0.01 will be considered as zero
length and removed</li>
<li><strong>endhole</strong> (<em>default False.</em>) &#8211; if true a gap at the end of the drillhole will be added.
The end of the drillhole is calculated from
drillhole.collar[&#8216;LENGTH&#8217;], and error will be raised if:
there is no &#8216;LENGTH&#8217; field at collar or if there are
undefined values at LENGTH. Warnings will be raised is the
TO  &gt; LENGTH.</li>
<li><strong>clean</strong> (<em>default True.</em>) &#8211; Delete temporary columns created with suffix __tmp__.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gap</span><span class="p">,</span><span class="n">overlap</span> <span class="o">=</span> <span class="n">mydrillhole</span><span class="o">.</span><span class="n">fix_zero_interval</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span> <span class="s1">&#39;assay&#39;</span><span class="p">,</span>
<span class="go">                                        new_table_name = &#39;tmp&#39;,</span>
<span class="go">                                        overwrite = False,</span>
<span class="go">                                        tol = 0.01,</span>
<span class="go">                                        clean = True,</span>
<span class="go">                                        endhole = False,</span>
<span class="go">                                        addgaps = True)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function removes zero intervals and the calls the add_gaps
function.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.drillhole.Drillhole.merge">
<code class="descname">merge</code><span class="sig-paren">(</span><em>str table_A</em>, <em>str table_B</em>, <em>str new_table_name</em>, <em>bint overwrite =False</em>, <em>double tol=0.01</em>, <em>bint clean=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.Drillhole.merge" title="Permalink to this definition">¶</a></dt>
<dd><p>Combines two tables by intersecting intervals.</p>
<p>This function requires drillholes without gaps and overlaps.
You may un add_gaps in table_A and table_B before using
this function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>table_A</strong> (<em>name of the first table</em>) &#8211; it must be an existing table at drillhole.table.keys()</li>
<li><strong>table_B</strong> (<em>name of the second table</em>) &#8211; it must be an existing table at drillhole.table.keys()</li>
<li><strong>new_table_name</strong> (<em>name of the new table</em>) &#8211; it may not exists at drillhole.table.keys()</li>
<li><strong>overwrite</strong> (<em>default True.</em>) &#8211; If new_table_name exists and overwrite == True the existing
table will be overwritten.</li>
<li><strong>tol</strong> (<em>default 0.01.</em>) &#8211; segments, gaps and overlays within tol will be ignore but
adjusted</li>
<li><strong>clean</strong> (<em>default True.</em>) &#8211; Delete temporary columns created with suffix __tmp__.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">table_A</span> <span class="o">=</span> <span class="s1">&#39;assay&#39;</span><span class="p">,</span>
<span class="go">                    table_B = &#39;litho&#39;,</span>
<span class="go">                    new_table_name = &#39;tmp&#39;,</span>
<span class="go">                    overwrite =False,</span>
<span class="go">                    tol=0.01,</span>
<span class="go">                    clean=True)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.drillhole.Drillhole.txt2intID">
<code class="descname">txt2intID</code><span class="sig-paren">(</span><em>str table_name</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.Drillhole.txt2intID" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an alternative BHID of type integer</p>
<p>A new <code class="docutils literal"><span class="pre">BHIDint</span></code> will be created on the <code class="docutils literal"><span class="pre">table[table_name]</span></code>
and in collar. <code class="docutils literal"><span class="pre">BHIDint</span></code> is just and ordered list of integers.</p>
<p>BHIDint may be required in some functions compiles in Fortran,
for example <code class="docutils literal"><span class="pre">pyslib.gslib.gamv</span></code> and <code class="docutils literal"><span class="pre">pyslib.gslib.kt3d</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>table_name</strong> (<em>str</em>) &#8211; </td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">collar</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="s1">&#39;BHID&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;assay&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="s1">&#39;BHID&#39;</span><span class="p">,</span> <span class="s1">&#39;FROM&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">txt2intID</span><span class="p">(</span><span class="s1">&#39;assay&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Collar and the table may be sorted.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.drillhole.Drillhole.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.Drillhole.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a set of basic validations on survey and collar
consisting of:</p>
<ul class="simple">
<li>check existence of Null values</li>
<li>check survey without values AT=0</li>
<li>check that coordinates and direction angles dtypes are float64</li>
<li>check survey without collar and collar without survey</li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>You may run this validation before doing desurvey</li>
<li>Only few validation test are implemented</li>
<li>Validation errors will raise a python error</li>
</ul>
</div>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Implement check relation between table, large variations in
survey angles, missing BHID.</li>
<li>Collect all errors and return a list of errors.</li>
<li>Collect all warnings and return a list of warnings.</li>
</ul>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.drillhole.Drillhole.validate_table" title="pygslib.drillhole.Drillhole.validate_table"><code class="xref py py-meth docutils literal"><span class="pre">validate_table()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.drillhole.Drillhole.validate_table">
<code class="descname">validate_table</code><span class="sig-paren">(</span><em>str table_name</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.Drillhole.validate_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a set of basic validations on interval tables
consisting of:</p>
<ul class="simple">
<li>checks null values in table BHID</li>
<li>checks null values in From/To</li>
<li>checks that FROM and TO dtypes are float64</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>You may run this validation before doing desurvey</li>
<li>Only few minimum validations are implemented for now</li>
<li>No value is returned, it raises an error</li>
</ul>
</div>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<p>Implement check relation between tables, gaps, overlays,
missing BHID, missing Survey, Interval longer that max_depth.</p>
<p class="last">Collect all errors and return a list of errors.
Collect all warnings and return a list of warnings.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.drillhole.Drillhole.validate" title="pygslib.drillhole.Drillhole.validate"><code class="xref py py-meth docutils literal"><span class="pre">validate()</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mydrillhole</span><span class="o">.</span><span class="n">validate_table</span><span class="p">(</span><span class="s1">&#39;assay&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pygslib.drillhole.ang2cart">
<code class="descclassname">pygslib.drillhole.</code><code class="descname">ang2cart</code><span class="sig-paren">(</span><em>float azm</em>, <em>float dip</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.ang2cart" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts azimuth and dip to x, y, z.</p>
<p>Returns the x,y,z coordinates of a 1 unit vector with origin of
coordinates at 0,0,0 and direction defined by azm (azimuth) and
dip (downward positive) angles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>azm,dip</strong> (<em>float, in degrees</em>) &#8211; The direction angles azimuth, with 0 or 360 pointing north and
the dip angle measured from horizontal surface positive downward</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>out</strong> &#8211; Cartesian coordinates.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple of floats, <code class="docutils literal"><span class="pre">(x,</span> <span class="pre">y,</span> <span class="pre">z)</span></code></td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">ang2cart</span><span class="p">(</span> <span class="n">azm</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span> <span class="n">dip</span> <span class="o">=</span> <span class="mi">75</span><span class="p">)</span>
<span class="go">(0.1830127239227295, 0.1830127090215683, -0.9659258127212524)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.drillhole.cart2ang" title="pygslib.drillhole.cart2ang"><code class="xref py py-func docutils literal"><span class="pre">cart2ang()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function is to convert direction angle into a Cartesian
representation, which are easy to interpolate. To convert
back x,y,z values to direction angles use the function cart2ang.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.drillhole.cart2ang">
<code class="descclassname">pygslib.drillhole.</code><code class="descname">cart2ang</code><span class="sig-paren">(</span><em>float x</em>, <em>float y</em>, <em>float z</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.cart2ang" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts x, y, z to azimuth and dip.</p>
<p>Returns the azimuth and dip of a 1 unit vector with origin of
coordinates at p1 [0,0,0] and p2 [x, y, z].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x,y,z</strong> (<em>float</em>) &#8211; Coordinates x, y, z of one unit length vector with origin of
coordinates at p1 [0,0,0]</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If x, y or z are outside the interval [-1,1] the values will be
truncated to 1. If the coordinates are outside this
interval due to rounding error then result will be ok, otherwise
the result will be wrong</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>out</strong> &#8211; The direction angles azimuth, with 0 or 360 pointing north and
the dip angle measured from horizontal surface positive downward</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple of floats, <code class="docutils literal"><span class="pre">(azm,</span> <span class="pre">dip)</span></code></td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">cart2ang</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.18301</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">0.18301</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.96593</span><span class="p">)</span>
<span class="go">(45.0, 75.00092315673828)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.drillhole.ang2cart" title="pygslib.drillhole.ang2cart"><code class="xref py py-func docutils literal"><span class="pre">ang2cart()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.drillhole.composite1dh">
<code class="descclassname">pygslib.drillhole.</code><code class="descname">composite1dh</code><span class="sig-paren">(</span><em>double[:] ifrom</em>, <em>double[:] ito</em>, <em>double[:] ivar</em>, <em>double cint = 1.</em>, <em>double minlen=-1.</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.composite1dh" title="Permalink to this definition">¶</a></dt>
<dd><p>Composites intervals in a single drillhole. The From-To intervals may be sorted.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See explanation of this implementation at
<a class="reference external" href="http://opengeostat.com/downhole-compositing-algorithm/">http://opengeostat.com/downhole-compositing-algorithm/</a></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ifrom,ito</strong> (<em>1D arrays of floats</em>) &#8211; From - To  interval</li>
<li><strong>ivar</strong> (<em>1D array of floats</em>) &#8211; variable to be composited</li>
<li><strong>cint</strong> (<em>Optional, float, default 1.</em>) &#8211; length of the compositing intervals</li>
<li><strong>minlen</strong> (<em>Optional, float, default -1.</em>) &#8211; minimum length of the composite, if &lt;=0 then minlen = cint/2.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>cfrom, cto</strong> (<em>1D arrays of floats</em>) &#8211; From, To composited intervals</li>
<li><strong>clen, cvar, cacum</strong> (<em>1D arrays of floats</em>) &#8211; total length of intervals composited
variable composited
variable accumulated</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfrom</span><span class="p">,</span> <span class="n">cto</span><span class="p">,</span> <span class="n">clen</span><span class="p">,</span> <span class="n">cvar</span><span class="p">,</span> <span class="n">cacum</span><span class="o">=</span> <span class="n">composite</span><span class="p">(</span><span class="n">ifrom</span><span class="p">,</span>
<span class="go">                                            ito,</span>
<span class="go">                                            ivar,</span>
<span class="go">                                            cint = 1,</span>
<span class="go">                                            minlen=-1)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.drillhole.Drillhole.downh_composite" title="pygslib.drillhole.Drillhole.downh_composite"><code class="xref py py-func docutils literal"><span class="pre">Drillhole.downh_composite()</span></code></a></p>
</div>
<div class="admonition-todo admonition" id="index-3">
<p class="first admonition-title">Todo</p>
<p class="last">Hide this function</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.drillhole.desurv1dh">
<code class="descclassname">pygslib.drillhole.</code><code class="descname">desurv1dh</code><span class="sig-paren">(</span><em>int indbs</em>, <em>int indes</em>, <em>np.ndarray[double</em>, <em>ndim=1] ats</em>, <em>np.ndarray[double</em>, <em>ndim=1] azs</em>, <em>np.ndarray[double</em>, <em>ndim=1] dips</em>, <em>float xc</em>, <em>float yc</em>, <em>float zc</em>, <em>float lpt</em>, <em>bint warns=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.desurv1dh" title="Permalink to this definition">¶</a></dt>
<dd><p>Desurveys one point with minimum curvature given survey array
and collar coordinates</p>
<p>It takes an array of survey points <code class="docutils literal"><span class="pre">ats,</span> <span class="pre">azs,</span> <span class="pre">dips</span></code> with a given
drillhole starting and ending at index <code class="docutils literal"><span class="pre">indbs,indes</span></code>, the
coordinates of the collar xc, xy, zc and derurvey a point at depth
<code class="docutils literal"><span class="pre">lpt</span></code> (any point at interval table, ex. a FROM interval in assay).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The survey may have ats==0 at index indbs but this is not
checked at this function.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>len12,azm1,dip1,azm2,dip2</strong> (<em>float</em>) &#8211; len12 is the length between a point 1 and a point 2.
azm1, dip1, azm2, dip2 are direction angles azimuth, with 0 or
360 pointing north and dip angles measured from horizontal
surface positive downward. All these angles are in degrees.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>out</strong> &#8211; Direction angles and coordinates at a point lpt</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple of floats, <code class="docutils literal"><span class="pre">(azt,dipt,xt,yt,zt)</span></code></td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">azt</span><span class="p">,</span><span class="n">dipt</span><span class="p">,</span><span class="n">xt</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span><span class="n">zt</span> <span class="o">=</span> <span class="n">desurv1dh</span><span class="p">(</span><span class="n">indbs</span><span class="p">,</span>
<span class="go">                                indes,</span>
<span class="go">                                ats,</span>
<span class="go">                                azs,</span>
<span class="go">                                dips,</span>
<span class="go">                                xc,</span>
<span class="go">                                yc,</span>
<span class="go">                                zc,</span>
<span class="go">                                lpt,</span>
<span class="go">                                warns=True)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.drillhole.Drillhole.desurvey" title="pygslib.drillhole.Drillhole.desurvey"><code class="xref py py-func docutils literal"><span class="pre">Drillhole.desurvey()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function is a convenience function call by Drillhole.desurvey
it was exposed here for validation purpose.</p>
</div>
<div class="admonition-todo admonition" id="index-4">
<p class="first admonition-title">Todo</p>
<p class="last">Hide this function</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.drillhole.dsmincurb">
<code class="descclassname">pygslib.drillhole.</code><code class="descname">dsmincurb</code><span class="sig-paren">(</span><em>float len12</em>, <em>float azm1</em>, <em>float dip1</em>, <em>float azm2</em>, <em>float dip2</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.dsmincurb" title="Permalink to this definition">¶</a></dt>
<dd><p>Desurveys one interval with minimum curvature</p>
<p>Given a line with length <code class="docutils literal"><span class="pre">len12</span></code> and endpoints p1,p2 with
direction angles <code class="docutils literal"><span class="pre">azm1,</span> <span class="pre">dip1,</span> <span class="pre">azm2,</span> <span class="pre">dip2</span></code>, this function returns
the differences in coordinate <code class="docutils literal"><span class="pre">dz,dn,de</span></code> of p2, assuming
p1 with coordinates (0,0,0)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>len12,azm1,dip1,azm2,dip2</strong> (<em>float</em>) &#8211; len12 is the length between a point 1 and a point 2.
azm1, dip1, azm2, dip2 are direction angles azimuth, with 0 or
360 pointing north and dip angles measured from horizontal
surface positive downward. All these angles are in degrees.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>out</strong> &#8211; Differences in elevation, north coordinate (or y) and
east coordinate (or x) in an Euclidean coordinate system.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple of floats, <code class="docutils literal"><span class="pre">(dz,dn,de)</span></code></td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">dsmincurb</span><span class="p">(</span><span class="n">len12</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">azm1</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">dip1</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">azm2</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">dip2</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="go">(7.207193374633789, 1.0084573030471802, 6.186459064483643)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.drillhole.ang2cart" title="pygslib.drillhole.ang2cart"><code class="xref py py-func docutils literal"><span class="pre">ang2cart()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The equations were derived from the paper</p>
<blockquote>
<div><cite>http://www.cgg.com/data//1/rec_docs/2269_MinimumCurvatureWellPaths.pdf</cite></div></blockquote>
<p class="last">The minimum curvature is a weighted mean based on the
dog-leg (dl) value and a Ratio Factor (rf = 2*tan(dl/2)/dl )
if dl is zero we assign rf = 1, which is equivalent to  balanced
tangential desurvey method. The dog-leg is zero if the direction
angles at the endpoints of the desurvey intervals are equal.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.drillhole.interp_ang1D">
<code class="descclassname">pygslib.drillhole.</code><code class="descname">interp_ang1D</code><span class="sig-paren">(</span><em>float azm1</em>, <em>float dip1</em>, <em>float azm2</em>, <em>float dip2</em>, <em>float len12</em>, <em>float d1</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.drillhole.interp_ang1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates the azimuth and dip angle over a line.</p>
<p>Given a line with length <code class="docutils literal"><span class="pre">len12</span></code> and endpoints with direction
angles <code class="docutils literal"><span class="pre">azm1,</span> <span class="pre">dip1,</span> <span class="pre">azm2,</span> <span class="pre">dip2</span></code>, this function returns the
direction angles of a point over this line, located at a distance
d1 of the point with direction angles <code class="docutils literal"><span class="pre">azm1,</span> <span class="pre">dip1</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>azm1,dip1,azm2,dip2,len12,d1</strong> (<em>float</em>) &#8211; azm1, dip1, azm2, dip2 are direction angles azimuth, with 0 or
360 pointing north and dip angles measured from horizontal
surface positive downward. All these angles are in degrees.
len12 is the length between a point 1 and a point 2 and
d1 is the positive distance from point 1 to a point located
between point 1 and point 2.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>out</strong> &#8211; The direction angles azimuth, with 0 or 360 pointing north and
the dip angle measured from horizontal surface positive downward</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple of floats, <code class="docutils literal"><span class="pre">(azm,</span> <span class="pre">dip)</span></code></td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">interp_ang1D</span><span class="p">(</span><span class="n">azm1</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
<span class="go">                       dip1=75,</span>
<span class="go">                       azm2=90,</span>
<span class="go">                       dip2=20,</span>
<span class="go">                       len12=10,</span>
<span class="go">                       d1=5)</span>
<span class="go">(80.74163055419922, 40.84182357788086)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.drillhole.ang2cart" title="pygslib.drillhole.ang2cart"><code class="xref py py-func docutils literal"><span class="pre">ang2cart()</span></code></a>, <a class="reference internal" href="#pygslib.drillhole.cart2ang" title="pygslib.drillhole.cart2ang"><code class="xref py py-func docutils literal"><span class="pre">cart2ang()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The output direction angles are interpolated using average weighted
by the distances <code class="docutils literal"><span class="pre">d1</span></code> and <code class="docutils literal"><span class="pre">len12-d1</span></code>. To avoid issues with
angles the azimuth and dip are converted to x,y,z, then interpolated
and finally converted back to azimuth,dip angles.</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-pygslib.blockmodel">
<span id="pygslib-blockmodel"></span><h2>PyGSLIB.blockmodel<a class="headerlink" href="#module-pygslib.blockmodel" title="Permalink to this headline">¶</a></h2>
<p>PyGSLIB Blockmodel, Module to handle blockmodel data.</p>
<p>Copyright (C) 2015 Adrian Martinez Vargas</p>
<p>This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 3 of the License, or
any later version.</p>
<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with this program.  If not, see &lt;<a class="reference external" href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;</p>
<dl class="class">
<dt id="pygslib.blockmodel.Blockmodel">
<em class="property">class </em><code class="descclassname">pygslib.blockmodel.</code><code class="descname">Blockmodel</code><a class="headerlink" href="#pygslib.blockmodel.Blockmodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Blockmodel object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nx,ny,nz</strong> (<em>integer</em>) &#8211; Number of rows columns and levels</li>
<li><strong>xorg,yorg,zorg</strong> (<em>float</em>) &#8211; Coordinates of the lower left corner (not centroid)</li>
<li><strong>dx,dy,dz</strong> (<em>float</em>) &#8211; Size of the parent block</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt>
<code class="descname">nx, ny, nz</code></dt>
<dd><p><em>int</em> &#8211; number of rows, columns, levels</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">xorg, yorg, zorg</code></dt>
<dd><p><em>float</em> &#8211; coordinates of the left lower corner of the first block</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">dx, dy, dz</code></dt>
<dd><p><em>float</em> &#8211; sizes of the blocks</p>
</dd></dl>

<dl class="attribute">
<dt id="pygslib.blockmodel.Blockmodel.bmtable">
<code class="descname">bmtable</code><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.bmtable" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Pandas DataFrame</em> &#8211; Table with blocks</p>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.block2point">
<code class="descname">block2point</code><span class="sig-paren">(</span><em>np.ndarray [double</em>, <em>ndim=1] x</em>, <em>np.ndarray [double</em>, <em>ndim=1] y</em>, <em>np.ndarray [double</em>, <em>ndim=1] z</em>, <em>str prop_name</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.block2point" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns a block property to the points inside a block</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x,y,z</strong> (<em>float 1D numpy arrays</em>) &#8211; coordinates of the points. Array shapes may be equal</li>
<li><strong>prop_name</strong> (<em>str</em>) &#8211; name of the property at block model</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Au_at_point</span><span class="o">=</span> <span class="n">point2block</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">prop_name</span><span class="o">=</span> <span class="s1">&#39;Au&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Points not laying in an existing block will be returned with
value numpy.nan</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.blockinsurface">
<code class="descname">blockinsurface</code><span class="sig-paren">(</span><em>object surface</em>, <em>str field</em>, <em>double azm=0</em>, <em>double dip =90</em>, <em>int test=1</em>, <em>bint overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.blockinsurface" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates blocks given a VTK surface (polydata) depending on
test criteria:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>surface</strong> (<em>VTK polydata</em>) &#8211; this may work with any 3D object..., no necessarily triangles</li>
<li><strong>field</strong> (<em>str</em>) &#8211; Name of the new field with selection results</li>
<li><strong>dip</strong> (<em>azm,</em>) &#8211; rotation defining the direction we will use to test the points
azm 0 will point north and dip positive means downward direction
(like surface drillholes)</li>
<li><strong>test</strong> (<em>integer, default 1</em>) &#8211; <blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">test</span> <span class="pre">==</span> <span class="pre">1</span></code> test inside closed surface. Here we use</dt>
<dd>vtkOBBTree::InsideOrOutside. Closed surface are required</dd>
</dl>
<p><code class="docutils literal"><span class="pre">test</span> <span class="pre">==</span> <span class="pre">2</span></code> test &#8216;above&#8217; surface
<code class="docutils literal"><span class="pre">test</span> <span class="pre">==</span> <span class="pre">3</span></code> test &#8216;below&#8217; surface
<code class="docutils literal"><span class="pre">test</span> <span class="pre">==</span> <span class="pre">4</span></code> test &#8216;inside&#8217; surface (the surface can be open)</p>
</div></blockquote>
<dl class="docutils">
<dt>overwrite</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span><dd>overwrite flag, if true and field exist in bmtable the
values will be overwritten</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillblocks</span><span class="p">(</span><span class="n">surface</span><span class="p">,</span> <span class="n">azm</span><span class="p">,</span> <span class="n">dip</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This function calls vtktools.pointquering for all the points
existing in the block model. The function is not optimized
for large model.</p>
<p class="last">A new set of blocks will be created if there is not block
defined. If there are blocks in the model and overwrite==True
the blocks will be removed first.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.blocks2vtkRectilinearGrid">
<code class="descname">blocks2vtkRectilinearGrid</code><span class="sig-paren">(</span><em>str path</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.blocks2vtkRectilinearGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports blocks of a full grid to a vtkRectilinearGrid file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> (<em>string</em>) &#8211; file name and path, without extension. The file extension
(<a href="#id3"><span class="problematic" id="id4">*</span></a>.vtr) will be added automatically.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blocks2vtkRectilinearGrid</span><span class="p">(</span><span class="s1">&#39;myfile&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This will only work for full grid, in other words, if all the
nx*ny*nz are defined.</p>
<p class="last">All the fields defined in the block model will be exported</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.blocks2vtkUnstructuredGrid">
<code class="descname">blocks2vtkUnstructuredGrid</code><span class="sig-paren">(</span><em>str path</em>, <em>str varname = None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.blocks2vtkUnstructuredGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports blocks of a partial grid to a vtkRectilinearGrid file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<em>string</em>) &#8211; file name and path, without extension. The file extension
(<a href="#id5"><span class="problematic" id="id6">*</span></a>.vtr) will be added automatically.</li>
<li><strong>varname</strong> (<em>string</em>) &#8211; If None export all columns, otherwise export only
the column varname</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blocks2vtkUnstructuredGrid</span><span class="p">(</span><span class="s1">&#39;myfile&#39;</span><span class="p">,</span> <span class="s1">&#39;AU&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Require XC, YC and ZC.</p>
<p>Only numeric variables can be exported
TODO: export all</p>
<p class="last">This call pygslib.vtktools.partialgrid2vtkfile</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.calc_ijk">
<code class="descname">calc_ijk</code><span class="sig-paren">(</span><em>bint overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.calc_ijk" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the IJK field from IX, IY, IZ indices
If IJK exist and overwrite=True the existing values
will be overwritten.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>overwrite</strong> (<em>Boolean, default False</em>) &#8211; If True overwrites any existing IJK field</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myblockmodel</span><span class="o">.</span><span class="n">calc_ijk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myblockmodel</span><span class="o">.</span><span class="n">calc_ijk</span><span class="p">(</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.calc_ixyz_fromijk">
<code class="descname">calc_ixyz_fromijk</code><span class="sig-paren">(</span><em>bint overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.calc_ixyz_fromijk" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the IX, IY, IZ fields from IJK index
If IX, IY, IZ exist and overwrite=True the existing values
will be overwritten.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>overwrite</strong> (<em>Boolean, default False</em>) &#8211; </td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myblockmodel</span><span class="o">.</span><span class="n">calc_ixyz_fromijk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myblockmodel</span><span class="o">.</span><span class="n">calc_ixyz_fromijk</span><span class="p">(</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.calc_ixyz_fromxyz">
<code class="descname">calc_ixyz_fromxyz</code><span class="sig-paren">(</span><em>bint overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.calc_ixyz_fromxyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the IX, IY, IZ fields from XC, YC, ZC coordinates
If IX, IY, IZ exist and overwrite=True the existing values
will be overwritten.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>overwrite</strong> (<em>Boolean, default False</em>) &#8211; </td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myblockmodel</span><span class="o">.</span><span class="n">calc_ixyz_fromxyz</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myblockmodel</span><span class="o">.</span><span class="n">calc_ixyz_fromxyz</span><span class="p">(</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.calc_xyz_fromixyz">
<code class="descname">calc_xyz_fromixyz</code><span class="sig-paren">(</span><em>bint overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.calc_xyz_fromixyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the XC, YC, ZC coordinates from IX, IY, IZ indices
If XC, YC, ZC exist and overwrite=True the existing values
will be overwritten.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>overwrite</strong> (<em>Boolean, default False</em>) &#8211; </td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myblockmodel</span><span class="o">.</span><span class="n">calc_xyz_fromixyz</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myblockmodel</span><span class="o">.</span><span class="n">calc_xyz_fromixyz</span><span class="p">(</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.create_IJK">
<code class="descname">create_IJK</code><span class="sig-paren">(</span><em>bint overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.create_IJK" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new block model table with IJK indices.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_IJK</span><span class="p">(</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A new set of blocks will be created if there is not block
defined. If there are blocks in the model and overwrite==True
the blocks will be removed first.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.delete_blocks">
<code class="descname">delete_blocks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.delete_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes the block model table</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myblockmodel</span><span class="o">.</span><span class="n">delete_blocks</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">myblockmodel</span><span class="o">.</span><span class="n">bmtable</span>
<span class="go">None</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This functions makes Blockmodel.bmtable=None. The data will
be preserved in any external instance of bmtable.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.fillwireframe">
<code class="descname">fillwireframe</code><span class="sig-paren">(</span><em>object surface</em>, <em>float toll=0</em>, <em>bint overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.fillwireframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a full block model given a VTK surface (polydata) using
vtkPolyDataToImageStencil. The results consist of blocks with
parameter <code class="docutils literal"><span class="pre">in</span></code>  with value between 0 and 1.</p>
<p><code class="docutils literal"><span class="pre">in</span> <span class="pre">=</span> <span class="pre">0</span></code> represent blocks completely outside the wireframe
<code class="docutils literal"><span class="pre">in</span> <span class="pre">=</span> <span class="pre">1</span></code> represent blocks completely inside the wireframe
<code class="docutils literal"><span class="pre">1</span> <span class="pre">&gt;in</span> <span class="pre">&gt;</span> <span class="pre">0</span></code> represent blocks cut by the wireframe</p>
<p>The parameter in is calculated as the sum of corners of the
block, each corner is equal to 1 if is inside the block or equal
to 0 if is outside.</p>
<p>The parameter <code class="docutils literal"><span class="pre">in</span></code> can be used as percentage of inclusion in
the block with an error proportional to the size of the block
and the resolution/complexity of the wireframe.</p>
<p>The method may fail if the wireframe is narrower than a block,
e.j. larg blocks in narrow veins. In this case you can set
a tolerance value 1&gt;=toll&gt;=0. The output may not be used as
volume, only as selection of blocks within a wireframe
(with <code class="docutils literal"><span class="pre">in&gt;0</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>surface</strong> (<em>VTK polydata</em>) &#8211; this may work with any 3D object..., no necessarily triangles</li>
<li><strong>tol</strong> (<em>float, default 0.0</em>) &#8211; number in interval [0. , 1.]
you may use tol&gt;0 if the blocks are large and the
wireframe is narrower than the block size.</li>
<li><strong>overwrite</strong> (<em>boolean</em>) &#8211; overwrite flag, if true the entire block model will be
overwritten</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mymodel</span><span class="o">.</span><span class="n">fillwireframe</span><span class="p">(</span><span class="n">surface</span><span class="p">,</span> <span class="n">toll</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The tolerance only works on x, y plane, not in z.</p>
<p>This function works well with closed surfaces</p>
<p class="last">This function works well with large and complicated wireframes,
for example, Leapfrog grade shells.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.point2block">
<code class="descname">point2block</code><span class="sig-paren">(</span><em>np.ndarray [double</em>, <em>ndim=1] x</em>, <em>np.ndarray [double</em>, <em>ndim=1] y</em>, <em>np.ndarray [double</em>, <em>ndim=1] z</em>, <em>object prop</em>, <em>str prop_name</em>, <em>bint average = False</em>, <em>bint overwrite = False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.point2block" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns data in a point to a block</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x,y,z</strong> (<em>Float 1D numpy arrays</em>) &#8211; coordinates of the points. Array shapes may be equal</li>
<li><strong>prop</strong> (<em>array like</em>) &#8211; array with property shape[0] == x.shape[0]
note that prop can be an array of array, for example, an
array of indicators arrays</li>
<li><strong>prop_name</strong> (<em>str</em>) &#8211; name of the property at block model</li>
<li><strong>average</strong> (<em>bool</em>) &#8211; If there are more than one point at block
average the points. If true the average will be created,
this may fail if prop is not numeric. If False the last
point in the block will be used to assign the value.</li>
<li><strong>overwrite</strong> (<em>bool</em>) &#8211; If False an existing property will not be overwritten</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point2block</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">prop_name</span><span class="o">=</span> <span class="s1">&#39;Au&#39;</span><span class="p">,</span>  <span class="n">average</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">overwrite</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>TODO: pass array of properties np.ndarray [double, ndim=2] prop and [prop_names]</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Points not laying in an existing block will be ignored.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.reblock">
<code class="descname">reblock</code><span class="sig-paren">(</span><em>double dx</em>, <em>double dy</em>, <em>double dz</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.reblock" title="Permalink to this definition">¶</a></dt>
<dd><p>Reblocks a block model</p>
<p>The model is reblocked using IJK calculated from XC, YC, ZC
coordinates and averaging all points with same IJK.</p>
<p>Note that this is like a point to block conversion and subblock
overlapping are not taken into account.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dx,dy,dz</strong> (<em>floats</em>) &#8211; New block dimensions. Note that new dimentions may be
greater or equal than old dimensions in all directions.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>block</strong> (<em>model instance with model reblocked</em>)</li>
<li><strong>err</strong> (<em>list of variables excluded (ej no numeric)</em>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The existing model will be overwritten</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.set_block_size">
<code class="descname">set_block_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.set_block_size" title="Permalink to this definition">¶</a></dt>
<dd><p>set_block_size(float dx,float dy, float dz)</p>
<p>Set block sizes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dx,dy,dz</strong> (<em>float</em>) &#8211; sizes of the blocks</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myblockmodel</span><span class="o">.</span><span class="n">set_block_size</span><span class="p">(</span><span class="n">dx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">dy</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">dz</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.set_blocks">
<code class="descname">set_blocks</code><span class="sig-paren">(</span><em>object bmtable</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.set_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns an external block model stored in a Pandas DataFrame
table.</p>
<p>One or many conditions apply</p>
<blockquote>
<div><ul class="simple">
<li>the block model has IJK field</li>
<li>or/and has IX, IY and IZ fields</li>
<li>or/and has XC, YC and ZC fields</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>bmtable</strong> (<em>Pandas DataFrame object</em>) &#8211; block model with special coordinate or index fields</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bmtable</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;IJK&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myblockmodel</span><span class="o">.</span><span class="n">set_blocks</span><span class="p">(</span><span class="n">bmtable</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Make sure IJK, IX,IY and IZ have dtype int32. XC,YC and ZC may
have dtype float32</p>
<p class="last">One of the above conditions is required. In case that two or
more of the special fields mentioned above are defined the
validity of the fields is not verified, for example the
valid IJK representation of fields IX, IY and IZ is not tested.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.set_origin">
<code class="descname">set_origin</code><span class="sig-paren">(</span><em>float xorg</em>, <em>float yorg</em>, <em>float zorg</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.set_origin" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the block model origin of coordinate. This is the lower
left corner of the lower left block (not-the centroid).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>xorg,yorg,zorg</strong> (<em>float</em>) &#8211; coordinates of the left lower corner of the first block</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myblockmodel</span><span class="o">.</span><span class="n">set_origin</span><span class="p">(</span><span class="n">xorg</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span><span class="n">yorg</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">zorg</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygslib.blockmodel.Blockmodel.set_rcl">
<code class="descname">set_rcl</code><span class="sig-paren">(</span><em>int nx</em>, <em>int ny</em>, <em>int nz</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.Blockmodel.set_rcl" title="Permalink to this definition">¶</a></dt>
<dd><p>Set number of blocks at row, call, level</p>
<p>Two conditions apply</p>
<ul class="simple">
<li>nx,ny and nz may be greater than zero</li>
<li>nx*ny*nz may be equal to the actual number of blocks</li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myblockmodel</span><span class="o">.</span><span class="n">set_rcl</span><span class="p">(</span><span class="n">nx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">nz</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myblockmodel</span><span class="o">.</span><span class="n">set_rcl</span><span class="p">(</span><span class="n">nx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">nz</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function basically reorders the blocks along rows, columns
and levels without changing the total number of blocks.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pygslib.blockmodel.ijk2ind">
<code class="descclassname">pygslib.blockmodel.</code><code class="descname">ijk2ind</code><span class="sig-paren">(</span><em>np.ndarray [long</em>, <em>ndim=1] ijk</em>, <em>unsigned int nx</em>, <em>unsigned int ny</em>, <em>unsigned int nz</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.ijk2ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the raw, column, level indices <code class="docutils literal"><span class="pre">ix,</span> <span class="pre">iy,</span> <span class="pre">iz</span></code> from IJK.</p>
<p>The IJK block index is a unique identifier of each block position.
This is equivalent to the position of a block in a <cite>gslib</cite> grid file.
All the points within a block will have the same IJK number.</p>
<p>From IJK you can calculate ix, iy and iz as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">iz</span> <span class="o">=</span>  <span class="n">ijk</span> <span class="o">/</span> <span class="n">nx</span><span class="o">*</span><span class="n">ny</span>
<span class="n">iy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ijk</span><span class="o">-</span><span class="n">iz</span><span class="o">*</span><span class="n">nx</span><span class="o">*</span><span class="n">ny</span><span class="p">)</span><span class="o">/</span><span class="n">nx</span>
<span class="n">ix</span> <span class="o">=</span>  <span class="n">ijk</span><span class="o">-</span><span class="n">iz</span><span class="o">*</span><span class="n">nx</span><span class="o">*</span><span class="n">ny</span> <span class="o">-</span> <span class="n">iy</span><span class="o">*</span><span class="n">nx</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ijk</strong> (<em>1D array of integers</em>) &#8211; arbitrary raw, level and column indices</li>
<li><strong>nx,ny,nz</strong> (<em>integers</em>) &#8211; number of blocks per row, column, level</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ix,iy,iz</strong> &#8211; The raw, column and level indices</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D array of integers</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ijk</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ix</span><span class="p">,</span><span class="n">iy</span><span class="p">,</span><span class="n">iz</span> <span class="o">=</span> <span class="n">ijk2ind</span><span class="p">(</span><span class="n">ijk</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">ix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">iy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">iz</span>
<span class="go">[0 1 0 1 0 1 0 1]</span>
<span class="go">[0 0 1 1 0 0 1 1]</span>
<span class="go">[0 0 0 0 1 1 1 1]</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.blockmodel.x2ix" title="pygslib.blockmodel.x2ix"><code class="xref py py-func docutils literal"><span class="pre">x2ix()</span></code></a>, <a class="reference internal" href="#pygslib.blockmodel.ijk2ind" title="pygslib.blockmodel.ijk2ind"><code class="xref py py-func docutils literal"><span class="pre">ijk2ind()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The indices ix, iy and iz start at zero</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.blockmodel.ind2ijk">
<code class="descclassname">pygslib.blockmodel.</code><code class="descname">ind2ijk</code><span class="sig-paren">(</span><em>np.ndarray [long</em>, <em>ndim=1] ix</em>, <em>np.ndarray [long</em>, <em>ndim=1] iy</em>, <em>np.ndarray [long</em>, <em>ndim=1] iz</em>, <em>unsigned int nx</em>, <em>unsigned int ny</em>, <em>unsigned int nz</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.ind2ijk" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the IJK block index</p>
<p>The IJK block index is a unique identifier of each block position.
This is equivalent to the position of a block in a <cite>gslib</cite> grid file.
All the points within a block will have the same IJK number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ix,iy,iz</strong> (<em>1D array of integers</em>) &#8211; arbitrary raw, level and column indices</li>
<li><strong>nx,ny,nz</strong> (<em>integers</em>) &#8211; number of blocks per row, column, level</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ijk</strong> &#8211; Unique identifier of block location</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D array of integers</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># a 2D grid with 2x2x1 cells</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iy</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind2ijk</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span><span class="n">iy</span><span class="p">,</span><span class="n">iz</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([2, 3, 0, 1])</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.blockmodel.x2ix" title="pygslib.blockmodel.x2ix"><code class="xref py py-func docutils literal"><span class="pre">x2ix()</span></code></a>, <a class="reference internal" href="#pygslib.blockmodel.ijk2ind" title="pygslib.blockmodel.ijk2ind"><code class="xref py py-func docutils literal"><span class="pre">ijk2ind()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The index IJK start at zero (first block) and ends at nx*ny*nz</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.blockmodel.ix2x">
<code class="descclassname">pygslib.blockmodel.</code><code class="descname">ix2x</code><span class="sig-paren">(</span><em>np.ndarray [long</em>, <em>ndim=1] ix</em>, <em>double xorg</em>, <em>double dx</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.ix2x" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the block coordinate (x, y or z)</p>
<p>Return array of coordinates x calculated from indices ix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ix</strong> (<em>1D array of positive integers</em>) &#8211; arbitrary index ix (or iy, or iz)</li>
<li><strong>xorg</strong> (<em>float</em>) &#8211; origin of coordinate (lower left corner of the block)</li>
<li><strong>dx</strong> (<em>float</em>) &#8211; size of the block</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>x</strong> &#8211; Coordinates x corresponding to index ix</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D array of floats</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.blockmodel.x2ix" title="pygslib.blockmodel.x2ix"><code class="xref py py-func docutils literal"><span class="pre">x2ix()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>The index starts at zero (first block)
If there is a point i with coordinate x[i] &lt; xorg and error will be
raised</p>
</dd></dl>

<dl class="function">
<dt id="pygslib.blockmodel.x2ix">
<code class="descclassname">pygslib.blockmodel.</code><code class="descname">x2ix</code><span class="sig-paren">(</span><em>np.ndarray [double</em>, <em>ndim=1] x</em>, <em>double xorg</em>, <em>double dx</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.blockmodel.x2ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the block index (ix, iy or iz)</p>
<p>Return array of ix indices representing the raw, column or level
in which a point with coordinate x is located. To get the three
indexes ix, iy, iz you may run this functions three times, changing
coordinates to x, y and z, respectively.</p>
<p>You can use this function to find the block which contain a points
with arbitrary coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>1D array of floats</em>) &#8211; arbitrary coordinates x (or y, or z)</li>
<li><strong>xorg</strong> (<em>float</em>) &#8211; origin of coordinate (lower left corner of the block)</li>
<li><strong>dx</strong> (<em>float</em>) &#8211; size of the block</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ix</strong> &#8211; Index of the blocks where points with coordinates x are located</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D array of integers</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">7.8</span><span class="p">,</span><span class="mf">15.9</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2ix</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">xorg</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([ 0,  5, 13, 18, 28, 29])</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.blockmodel.ind2ijk" title="pygslib.blockmodel.ind2ijk"><code class="xref py py-func docutils literal"><span class="pre">ind2ijk()</span></code></a>, <a class="reference internal" href="#pygslib.blockmodel.ijk2ind" title="pygslib.blockmodel.ijk2ind"><code class="xref py py-func docutils literal"><span class="pre">ijk2ind()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The index starts at zero (first block)
If there is a point i with coordinate x[i] &lt; xorg and error will be
raised</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-pygslib.vtktools">
<span id="pygslib-vtktools"></span><h2>PyGSLIB.vtktools<a class="headerlink" href="#module-pygslib.vtktools" title="Permalink to this headline">¶</a></h2>
<p>PyGSLIB vtktools, Module with tools to work with VTK.</p>
<p>Copyright (C) 2015 Adrian Martinez Vargas</p>
<p>This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 3 of the License, or
any later version.</p>
<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with this program.  If not, see &lt;<a class="reference external" href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;</p>
<dl class="function">
<dt id="pygslib.vtktools.GetPointsInPolydata">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">GetPointsInPolydata</code><span class="sig-paren">(</span><em>object polydata</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.GetPointsInPolydata" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the point coordinates in a polydata (e.j. wireframe)
as a numpy array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>polydata</strong> (<em>VTK polydata</em>) &#8211; vtk object with data, ej. wireframe</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>p</strong> &#8211; Points coordinates in polydata object</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">2D array of float</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.vtktools.SetPointsInPolydata" title="pygslib.vtktools.SetPointsInPolydata"><code class="xref py py-func docutils literal"><span class="pre">SetPointsInPolydata()</span></code></a>, <a class="reference internal" href="#pygslib.vtktools.SavePolydata" title="pygslib.vtktools.SavePolydata"><code class="xref py py-func docutils literal"><span class="pre">SavePolydata()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.vtktools.SavePolydata">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">SavePolydata</code><span class="sig-paren">(</span><em>object polydata</em>, <em>str path</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.SavePolydata" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves polydata into a VTK XML polydata file (&#8216;<a href="#id7"><span class="problematic" id="id8">*</span></a>.vtp&#8217;)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>polydata</strong> (<em>VTK polydata</em>) &#8211; vtk object with data, ej. wireframe</li>
<li><strong>path</strong> (<em>str</em>) &#8211; Extension (<a href="#id9"><span class="problematic" id="id10">*</span></a>.vtp) will be added if not provided</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pygslib.vtktools.SetPointsInPolydata">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">SetPointsInPolydata</code><span class="sig-paren">(</span><em>object polydata</em>, <em>object points</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.SetPointsInPolydata" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the points coordinates in a VTK polydata object (e.j. wireframe).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>polydata</strong> (<em>VTK polydata</em>) &#8211; vtk object with data, ej. wireframe</li>
<li><strong>points</strong> (<em>2D array</em>) &#8211; New points coordinates to be set in the polydata
points shape may be equal to [polydata.GetNumberOfPoints(),3]</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.vtktools.GetPointsInPolydata" title="pygslib.vtktools.GetPointsInPolydata"><code class="xref py py-func docutils literal"><span class="pre">GetPointsInPolydata()</span></code></a>, <a class="reference internal" href="#pygslib.vtktools.SavePolydata" title="pygslib.vtktools.SavePolydata"><code class="xref py py-func docutils literal"><span class="pre">SavePolydata()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.vtktools.addLine">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">addLine</code><span class="sig-paren">(</span><em>object renderer</em>, <em>object p1</em>, <em>object p2</em>, <em>object color=(0.0</em>, <em>0.0</em>, <em>1.0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.addLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a line into an existing VTK renderer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>renderer</strong> (<em>VTK renderer</em>) &#8211; renderer with vtk objects and properties</li>
<li><strong>p1,p2</strong> (<em>tuple with 3 float</em>) &#8211; point location</li>
<li><strong>radius</strong> (<em>radius of the point</em>) &#8211; Default 1.</li>
<li><strong>color</strong> (<em>tuple with 3 float</em>) &#8211; Default (0.0, 0.0, 0.0)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>VtkRenderer</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">an Vtk renderer containing VTK polydata</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.vtktools.vtk_show" title="pygslib.vtktools.vtk_show"><code class="xref py py-func docutils literal"><span class="pre">vtk_show()</span></code></a>, <a class="reference internal" href="#pygslib.vtktools.loadSTL" title="pygslib.vtktools.loadSTL"><code class="xref py py-func docutils literal"><span class="pre">loadSTL()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This Code was modified from the original code by Adamos Kyriakou
published in <a class="reference external" href="https://pyscience.wordpress.com/">https://pyscience.wordpress.com/</a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.vtktools.addPoint">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">addPoint</code><span class="sig-paren">(</span><em>object renderer</em>, <em>object p</em>, <em>double radius=1.0</em>, <em>object color=(0.0</em>, <em>0.0</em>, <em>0.0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.addPoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a point into an existing VTK renderer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>renderer</strong> (<em>VTK renderer</em>) &#8211; renderer with vtk objects and properties</li>
<li><strong>p</strong> (<em>tuple with 3 float</em>) &#8211; point location</li>
<li><strong>radius</strong> (<em>radius of the point</em>) &#8211; Default 1.</li>
<li><strong>color</strong> (<em>tuple with 3 float</em>) &#8211; Default (0.0, 0.0, 0.0)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>VtkRenderer</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">an Vtk renderer containing VTK polydata</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.vtktools.vtk_show" title="pygslib.vtktools.vtk_show"><code class="xref py py-func docutils literal"><span class="pre">vtk_show()</span></code></a>, <a class="reference internal" href="#pygslib.vtktools.loadSTL" title="pygslib.vtktools.loadSTL"><code class="xref py py-func docutils literal"><span class="pre">loadSTL()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This Code was modified from the original code by Adamos Kyriakou
published in <a class="reference external" href="https://pyscience.wordpress.com/">https://pyscience.wordpress.com/</a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.vtktools.dmtable2wireframe">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">dmtable2wireframe</code><span class="sig-paren">(</span><em>np.ndarray [double</em>, <em>ndim=1] x</em>, <em>np.ndarray [double</em>, <em>ndim=1] y</em>, <em>np.ndarray [double</em>, <em>ndim=1] z</em>, <em>np.ndarray [long</em>, <em>ndim=1] pid</em>, <em>np.ndarray [long</em>, <em>ndim=1] pid1</em>, <em>np.ndarray [long</em>, <em>ndim=1] pid2</em>, <em>np.ndarray [long</em>, <em>ndim=1] pid3</em>, <em>str filename = None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.dmtable2wireframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a wireframe defined by two tables and creates a VTK polydata wireframe object.</p>
<p>The input tables are as follow:</p>
<ul class="simple">
<li>x, y, z : This is the points table</li>
<li>pid1,pid2,pid3: This is another table defining triangles with
three point IDs.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x,y,z</strong> (<em>1D array of floats</em>) &#8211; coordinates of the points to be tested</li>
<li><strong>pid1,pid2,pid3</strong> (<em>1D array of integers</em>) &#8211; triangles defined by three existing point IDs</li>
<li><strong>filename</strong> (<em>str</em>) &#8211; file name and path. If provided the file wireframe is saved to
this file.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>surface</strong> &#8211; wireframe imported</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">VTK polydata</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="docutils literal"><span class="pre">pid</span></code> is the row number in the point table.</p>
<p><code class="docutils literal"><span class="pre">pid</span></code> indices start at zero</p>
<p>For example:</p>
<p>a point table</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">x</th>
<th class="head">y</th>
<th class="head">z</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>.0</td>
<td>.0</td>
<td>.0</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>.0</td>
<td>.0</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="0">
<li></li>
</ol>
</td>
<td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>.0</td>
</tr>
</tbody>
</table>
<p>a triangle table</p>
<table border="1" class="last docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">pid1</th>
<th class="head">pid2</th>
<th class="head">pid3</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>1</td>
<td>2</td>
</tr>
</tbody>
</table>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.vtktools.getbounds">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">getbounds</code><span class="sig-paren">(</span><em>object polydata</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.getbounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the bounding box limits x,y,z minimum and maximum</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>polydata</strong> (<em>VTK polydata</em>) &#8211; vtk object with data, ej. wireframe</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>xmin,xmax,ymin,ymax,zmin,zmax</strong> &#8211; The geometry bounding box</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pygslib.vtktools.grid2vtkfile">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">grid2vtkfile</code><span class="sig-paren">(</span><em>str path</em>, <em>np.ndarray [double</em>, <em>ndim=1] x</em>, <em>np.ndarray [double</em>, <em>ndim=1] y</em>, <em>np.ndarray [double</em>, <em>ndim=1] z</em>, <em>object data</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.grid2vtkfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves data in a Vtk Rectilinear Grid file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<em>str</em>) &#8211; file path (relative or absolute) and name</li>
<li><strong>x,y,z</strong> (<em>np.ndarray</em>) &#8211; coordinates of the points</li>
<li><strong>data</strong> (<em>array like</em>) &#8211; array with variable values.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pygslib.vtktools.loadSTL">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">loadSTL</code><span class="sig-paren">(</span><em>str filenameSTL</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.loadSTL" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a STL wireframe file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filenameSTL</strong> (<em>file path</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>polydata</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">VTK Polydata object</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Code by Adamos Kyriakou
published in <a class="reference external" href="https://pyscience.wordpress.com/">https://pyscience.wordpress.com/</a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.vtktools.partialgrid2vtkfile">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">partialgrid2vtkfile</code><span class="sig-paren">(</span><em>str path</em>, <em>np.ndarray [double</em>, <em>ndim=1] x</em>, <em>np.ndarray [double</em>, <em>ndim=1] y</em>, <em>np.ndarray [double</em>, <em>ndim=1] z</em>, <em>double DX</em>, <em>double DY</em>, <em>double DZ</em>, <em>object var</em>, <em>object varname</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.partialgrid2vtkfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves data in a VTK Unstructured Grid file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<em>str</em>) &#8211; file path (relative or absolute) and name</li>
<li><strong>x,y,z</strong> (<em>np.ndarray</em>) &#8211; coordinates of the points</li>
<li><strong>DX,DY,DZ</strong> (<em>float</em>) &#8211; block sizes</li>
<li><strong>data</strong> (<em>array like</em>) &#8211; array with variable values.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pygslib.vtktools.pointinsolid">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">pointinsolid</code><span class="sig-paren">(</span><em>object surface</em>, <em>np.ndarray [double</em>, <em>ndim=1] x</em>, <em>np.ndarray [double</em>, <em>ndim=1] y</em>, <em>np.ndarray [double</em>, <em>ndim=1] z</em>, <em>double tolerance = .000001</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.pointinsolid" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds points inside a closed surface using vtkSelectEnclosedPoints</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>surface</strong> (<em>VTK polydata</em>) &#8211; this may work with any 3D object..., no necessarily triangles</li>
<li><strong>x,y,z</strong> (<em>1D array of floats</em>) &#8211; coordinates of the points to be tested</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>inside</strong> &#8211; Indicator of point inclusion with values [0,1]
0 means that the point is not inside
1 means that the point is inside</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D array of integers</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.vtktools.vtk_raycasting" title="pygslib.vtktools.vtk_raycasting"><code class="xref py py-func docutils literal"><span class="pre">vtk_raycasting()</span></code></a>, <a class="reference internal" href="#pygslib.vtktools.pointquering" title="pygslib.vtktools.pointquering"><code class="xref py py-func docutils literal"><span class="pre">pointquering()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>It is assumed that the surface is closed and manifold.
Note that if this check is not performed and the surface is not
closed, the results are undefined.</p>
<p class="last">TODO: add check to verify that a surface is closed</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.vtktools.pointquering">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">pointquering</code><span class="sig-paren">(</span><em>object surface</em>, <em>double azm</em>, <em>double dip</em>, <em>np.ndarray [double</em>, <em>ndim=1] x</em>, <em>np.ndarray [double</em>, <em>ndim=1] y</em>, <em>np.ndarray [double</em>, <em>ndim=1] z</em>, <em>int test</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.pointquering" title="Permalink to this definition">¶</a></dt>
<dd><p>Find points inside, over and below surface/solid</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>surface</strong> (<em>VTK polydata</em>) &#8211; this may work with any 3D object..., no necessarily triangles</li>
<li><strong>dip</strong> (<em>azm,</em>) &#8211; rotation defining the direction we will use to test the points
azm 0 will point north and dip positive meas downward direction
(like surface drillholes)</li>
<li><strong>x,y,z</strong> (<em>1D array of floats</em>) &#8211; coordinates of the points to be tested</li>
<li><strong>test</strong> (<em>integer</em>) &#8211; If <code class="docutils literal"><span class="pre">test==1</span></code> it queries points inside closed surface. It
only works with closed solids.
If <code class="docutils literal"><span class="pre">test==2</span></code> it queries point above surface.
If <code class="docutils literal"><span class="pre">test==3</span></code> it queries point below surface.
If <code class="docutils literal"><span class="pre">test==4</span></code> it queries point above and below the surface.
<code class="docutils literal"><span class="pre">test==4</span></code> is similar to <code class="docutils literal"><span class="pre">test==1</span></code> but it works with
open surfaces.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>inside</strong> (<em>1D array of integers</em>) &#8211; Indicator of point inclusion with values [0,1]
0 means that the point is not inside, above or below surface
1 means that the point is inside, above or below surface</li>
<li><strong>p1</strong> (<em>1D array size 3</em>) &#8211; rays to show where are pointing in the output</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.vtktools.vtk_raycasting" title="pygslib.vtktools.vtk_raycasting"><code class="xref py py-func docutils literal"><span class="pre">vtk_raycasting()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The test 1 requires the surface to be close, to find points between
two surfaces you can use test=4
The test, 2,3 and 4 use raycasting and rays orientation are defined
by azm and dip values. The results will depend on this direction,
for example, to find the points between two open surfaces you may
use ray direction perpendicular to surfaces
If a surface is closed the points over and below a surface will
include points inside surface</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.vtktools.points2vtkfile">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">points2vtkfile</code><span class="sig-paren">(</span><em>str path</em>, <em>np.ndarray [double</em>, <em>ndim=1] x</em>, <em>np.ndarray [double</em>, <em>ndim=1] y</em>, <em>np.ndarray [double</em>, <em>ndim=1] z</em>, <em>object data</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.points2vtkfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Save points in vtk file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<em>str</em>) &#8211; file path (relative or absolute) and name</li>
<li><strong>x,y,z</strong> (<em>np.ndarray</em>) &#8211; coordinates of the points</li>
<li><strong>data</strong> (<em>array like</em>) &#8211; array with variable values.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pygslib.vtktools.polydata2renderer">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">polydata2renderer</code><span class="sig-paren">(</span><em>object polydata</em>, <em>object color=(1.</em>, <em>0.</em>, <em>0.)</em>, <em>double opacity=1</em>, <em>object background=(1.</em>, <em>1.</em>, <em>1.)</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.polydata2renderer" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates vtk renderer from vtk polydata</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>polydata</strong> (<em>VTK polydata</em>) &#8211; </li>
<li><strong>color</strong> (<em>tuple with 3 floats (RGB)</em>) &#8211; default color=(1.,0.,0.)</li>
<li><strong>opacity</strong> (<em>float</em>) &#8211; default 1 (opaque)</li>
<li><strong>background</strong> (<em>tuple with 3 floats (RGB)</em>) &#8211; default background=(1.,1.,1.)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>VtkRenderer</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">an Vtk renderer containing VTK polydata</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.vtktools.vtk_show" title="pygslib.vtktools.vtk_show"><code class="xref py py-func docutils literal"><span class="pre">vtk_show()</span></code></a>, <a class="reference internal" href="#pygslib.vtktools.loadSTL" title="pygslib.vtktools.loadSTL"><code class="xref py py-func docutils literal"><span class="pre">loadSTL()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This Code was modified from the original code by Adamos Kyriakou
published in <a class="reference external" href="https://pyscience.wordpress.com/">https://pyscience.wordpress.com/</a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.vtktools.vtk_raycasting">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">vtk_raycasting</code><span class="sig-paren">(</span><em>object surface</em>, <em>object pSource</em>, <em>object pTarget</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.vtk_raycasting" title="Permalink to this definition">¶</a></dt>
<dd><p>Intersects a line defined by two points with a polydata vtk object,
for example a closed surface.</p>
<p>This function is to find intersection and inclusion of points
within, below or over a surface. This is handy to select points
or define blocks inside solids.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>surface</strong> (<em>VTK polydata</em>) &#8211; this may work with any 3D object..., no necessarily triangles</li>
<li><strong>pTarget</strong> (<em>pSource,</em>) &#8211; point location defining a ray</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul>
<li><dl class="first docutils">
<dt><strong>intersect</strong> (<em>integer, with values -1, 0, 1</em>) &#8211;  0 means that no intersection points were found</dt>
<dd><p class="first last">1 means that some intersection points were found</p>
</dd>
</dl>
<p>-1 means the ray source lies within the surface</p>
</li>
<li><p class="first"><strong>pointsIntersection</strong> (<em>tuple of tuples with 3 float</em>) &#8211; this is a tuple with coordinates tuples defining
intersection points</p>
</li>
<li><p class="first"><strong>pointsVTKIntersectionData</strong> (<em>an Vtk polydata object</em>) &#8211; similar to pointsIntersection but in Vtk polydata format</p>
</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.vtktools.vtk_show" title="pygslib.vtktools.vtk_show"><code class="xref py py-func docutils literal"><span class="pre">vtk_show()</span></code></a>, <a class="reference internal" href="#pygslib.vtktools.loadSTL" title="pygslib.vtktools.loadSTL"><code class="xref py py-func docutils literal"><span class="pre">loadSTL()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This Code was modified from the original code by Adamos Kyriakou
published in <a class="reference external" href="https://pyscience.wordpress.com/">https://pyscience.wordpress.com/</a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.vtktools.vtk_show">
<code class="descclassname">pygslib.vtktools.</code><code class="descname">vtk_show</code><span class="sig-paren">(</span><em>object renderer</em>, <em>double width=400</em>, <em>double height=300</em>, <em>double camera_position=None</em>, <em>double camera_focalpoint=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.vtktools.vtk_show" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays a vtk renderer in Ipython Image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>renderer</strong> (<em>VTK renderer</em>) &#8211; renderer with vtk objects and properties</li>
<li><strong>height</strong> (<em>width,</em>) &#8211; Size of the image, default (400,300)</li>
<li><strong>camera_focalpoint</strong> (<em>camera_position,</em>) &#8211; camera position, camera focal point (ex. center of mass)
default None. If not None the the camera will be overwrite</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Image</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">an IPython display Image object</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.vtktools.polydata2renderer" title="pygslib.vtktools.polydata2renderer"><code class="xref py py-func docutils literal"><span class="pre">polydata2renderer()</span></code></a>, <a class="reference internal" href="#pygslib.vtktools.loadSTL" title="pygslib.vtktools.loadSTL"><code class="xref py py-func docutils literal"><span class="pre">loadSTL()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This Code was modified from the original code by Adamos Kyriakou
published in <a class="reference external" href="https://pyscience.wordpress.com/">https://pyscience.wordpress.com/</a></p>
</div>
</dd></dl>

</div>
<div class="section" id="module-pygslib.nonlinear">
<span id="pygslib-nonlinear"></span><h2>PyGSLIB.nonlinear<a class="headerlink" href="#module-pygslib.nonlinear" title="Permalink to this headline">¶</a></h2>
<p>PyGSLIB nonlinear, Module with function for nonlinear geostatistics</p>
<p>Copyright (C) 2015 Adrian Martinez Vargas</p>
<p>This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 3 of the License, or
any later version.</p>
<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with this program.  If not, see &lt;<a class="reference external" href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;</p>
<p>Code based on paper</p>
<blockquote>
<div>A Step by Step Guide to Bi-Gaussian Disjunctive Kriging, by
Julian M. Ortiz, Bora Oz, Clayton V. Deutsch
Geostatistics Banff 2004
Volume 14 of the series Quantitative Geology and Geostatistics pp 1097-1102</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This module is experimental, not tested and we are getting some validation
errors in the anamorphosis with declustering data.</p>
</div>
<dl class="function">
<dt id="pygslib.nonlinear.Y2Z">
<code class="descclassname">pygslib.nonlinear.</code><code class="descname">Y2Z</code><span class="sig-paren">(</span><em>np.ndarray [double</em>, <em>ndim=1] y</em>, <em>np.ndarray [double</em>, <em>ndim=1] PCI</em>, <em>double zamin</em>, <em>double yamin</em>, <em>double zpmin</em>, <em>double ypmin</em>, <em>double zpmax</em>, <em>double ypmax</em>, <em>double zamax</em>, <em>double yamax</em>, <em>double r=1</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.nonlinear.Y2Z" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaussian (Y) to raw (Z) transformation</p>
<p>This is a convenience functions. It calls H=recurrentH(K,Y) and
then returns Z = expand_anamor(PCI,H,r). K is deduced from
PCI.shape[0]. It also linearly interpolates the values
out of the control points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>PCI</strong> (<em>1D array of float64</em>) &#8211; hermite coefficient</li>
<li><strong>y</strong> (<em>1D array of float64</em>) &#8211; Gaussian values</li>
<li><strong>r</strong> (<em>float64, default 1</em>) &#8211; the support effect</li>
<li><strong>ypmin,zpmin,ypmax,zpmax</strong> (<em>float64</em>) &#8211; z, y practical minimum and maximum</li>
<li><strong>yamin,zamin,yamax,zamax</strong> (<em>float64</em>) &#8211; z, y authorized minimum and maximum</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Z</strong> &#8211; raw values corresponding to Y</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D array of floats</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.nonlinear.recurrentH" title="pygslib.nonlinear.recurrentH"><code class="xref py py-func docutils literal"><span class="pre">recurrentH()</span></code></a>, <a class="reference internal" href="#pygslib.nonlinear.expand_anamor" title="pygslib.nonlinear.expand_anamor"><code class="xref py py-func docutils literal"><span class="pre">expand_anamor()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.nonlinear.Z2Y_linear">
<code class="descclassname">pygslib.nonlinear.</code><code class="descname">Z2Y_linear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.nonlinear.Z2Y_linear" title="Permalink to this definition">¶</a></dt>
<dd><p>Z2Y_linear(np.ndarray [double, ndim=1] z, np.ndarray [double, ndim=1] zm, np.ndarray [double, ndim=1] ym, double zamin, double yamin, double zpmin, double ypmin, double zpmax, double ypmax, double zamax, double yamax)</p>
<p>Raw (Z) to Gaussian (Y) transformation</p>
<p>Given a set of pairs [zm,ym] representing an experimental
Gaussian anamorphosis, this functions linearly interpolate y values
corresponding to z within the [zamin, zamax] intervals</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z</strong> (<em>1D array of float64</em>) &#8211; raw (Z) values where we want to know Gaussian (Y) equivalent</li>
<li><strong>zm,ym</strong> (<em>1D array of float64</em>) &#8211; tabulated [Z,Y] values</li>
<li><strong>zpmin, ypmax, zpmax</strong> (<em>ypmin,</em>) &#8211; z, y practical minimum and maximum</li>
<li><strong>zamin, yamax,zamax</strong> (<em>yamin,</em>) &#8211; z, y authorized minimum and maximum</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Z</strong> &#8211; raw values corresponding to Y</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D array of float64</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.nonlinear.Y2Z" title="pygslib.nonlinear.Y2Z"><code class="xref py py-func docutils literal"><span class="pre">Y2Z()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.nonlinear.ctrpoints">
<code class="descclassname">pygslib.nonlinear.</code><code class="descname">ctrpoints</code><span class="sig-paren">(</span><em>np.ndarray [double</em>, <em>ndim=1] z</em>, <em>np.ndarray [double</em>, <em>ndim=1] y</em>, <em>np.ndarray [double</em>, <em>ndim=1] ze</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.nonlinear.ctrpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Infers some control points.</p>
<p>The admissible minimum and maximum are just logic values defined
by user or by the nature of the problem, ej. grade values may be
between 0 and 100 percent.</p>
<p>The practical minimum and maximum are selected as follow</p>
<blockquote>
<div><ul class="simple">
<li>are within admissible interval</li>
<li>are within data minimum and maximum values</li>
<li>are within interval where ze do not fluctuates</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z,y</strong> (<em>1D array of floats</em>) &#8211; experimental transformation table</li>
<li><strong>ze</strong> (<em>1D array of floats</em>) &#8211; z values obtained with polynomial expansion of y, in other
ze may be calculated as expand_anamor(PCI,H,r=1)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>zamin,yamin,zamax,yamax,zpmin,ypmin,zpmax,ypmax</strong> &#8211; Control points</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">floats</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pygslib.nonlinear.expand_anamor">
<code class="descclassname">pygslib.nonlinear.</code><code class="descname">expand_anamor</code><span class="sig-paren">(</span><em>np.ndarray [double</em>, <em>ndim=1] PCI</em>, <em>np.ndarray [double</em>, <em>ndim=2] H</em>, <em>double r=1.</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.nonlinear.expand_anamor" title="Permalink to this definition">¶</a></dt>
<dd><p>Expands the anamorphosis function, that is <span class="math">\(Z = \sum_p(PSI_p*r^p*Hp(Yv))\)</span></p>
<p>r is the support effect. If r = 1 Z with point support will returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>PCI</strong> (<em>1D array of floats</em>) &#8211; hermite coefficient</li>
<li><strong>H</strong> (<em>2D array of floats</em>) &#8211; Hermite monomials H(i,y) with shape [K+1,len(y)]. See recurrentH</li>
<li><strong>r</strong> (<em>float, default 1</em>) &#8211; the support effect</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>PCI</strong> &#8211; Hermite coefficients or PCI</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D array of floats</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.nonlinear.recurrentH" title="pygslib.nonlinear.recurrentH"><code class="xref py py-func docutils literal"><span class="pre">recurrentH()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.nonlinear.f_covar_ZvZv">
<code class="descclassname">pygslib.nonlinear.</code><code class="descname">f_covar_ZvZv</code><span class="sig-paren">(</span><em>double ro</em>, <em>double s</em>, <em>double r</em>, <em>np.ndarray [double</em>, <em>ndim=1] PCI</em>, <em>double Covar_ZvZv=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.nonlinear.f_covar_ZvZv" title="Permalink to this definition">¶</a></dt>
<dd><p>This is an internal function used to deduce the coefficients
ro = covar(Yv, Yv*). This function represents the expression:</p>
<blockquote>
<div><span class="math">\(Covar (Zv,Zv^*) = \sum PCI^2 * r^n * s^n * ro^n\)</span></div></blockquote>
<p>ro is necessary to account for the conditional bias in the
information effect.</p>
<p>see &#8220;The information effect and estimating recoverable reserves&#8221;
J. Deraisme (Geovariances), C. Roth (Geovariances) for more information</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ro, s</strong> (<em>r,</em>) &#8211; support effect and information effect coefficients.</li>
<li><strong>PCI</strong> (<em>1D array of floats</em>) &#8211; hermite coefficients</li>
<li><strong>Covar_ZvZv</strong> (<em>float</em>) &#8211; Block covariance (correlation) between true Zv and estimate Zv*</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><span class="math">\(Covar (Zv,Zv^*) = var(Zv) - Kriging variance - LaGrange multiplier\)</span></p>
<p>see expression 7.47, page 97 on Basic Linear Geostatistics by
Margaret Armstrong.</p>
<p>In case of information effect this can be calculated with a dummy
dataset in a single block representing future information, for
example blast holes.</p>
<p>Note that the slop of regression is</p>
<p class="last"><span class="math">\(p = Covar (Zv,Zv*) / (Covar (Zv,Zv*)  - LaGrange multiplier)\)</span></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.nonlinear.f_var_Zv">
<code class="descclassname">pygslib.nonlinear.</code><code class="descname">f_var_Zv</code><span class="sig-paren">(</span><em>double r</em>, <em>np.ndarray [double</em>, <em>ndim=1] PCI</em>, <em>double Var_Zv=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.nonlinear.f_var_Zv" title="Permalink to this definition">¶</a></dt>
<dd><p>This is an internal function used to deduce the coefficients r
(or s), representing the support effect. It defines the relations:</p>
<blockquote>
<div><p><span class="math">\(Var(Zv) = \sum PCI^2 * r^(n*2)\)</span></p>
<p>or</p>
<p><span class="math">\(Var(Zv*) = \sum PCI^2 * s^(n*2)\)</span></p>
</div></blockquote>
<p>r is necessary to account for information effect
s is necessary to account for smoothing in the information effect.</p>
<p>see &#8220;The information effect and estimating recoverable reserves&#8221;
J. Deraisme (Geovariances), C. Roth (Geovariances) for more information</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>r</strong> (<em>float64</em>) &#8211; r or s coefficient representing support effect of Zv (or Zv*)</li>
<li><strong>PCI</strong> (<em>1D array of floats</em>) &#8211; hermite coefficients</li>
<li><strong>Var_Zv</strong> (<em>float64</em>) &#8211; Block Variance var(Zv) or var(Zv*)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>var(Zv) can be calculated as C(0)-gamma(v,v) or C(v,v) see function
block_covariance</p>
<p>var(Zv*) = var(Zv) - Kriging variance - 2*LaGrange multiplier</p>
<p class="last">In case of information effect this can be calculated with a dummy
dataset in a single block representing future information, for
example blast holes.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.nonlinear.fit_PCI">
<code class="descclassname">pygslib.nonlinear.</code><code class="descname">fit_PCI</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.nonlinear.fit_PCI" title="Permalink to this definition">¶</a></dt>
<dd><p>fit_PCI(np.ndarray [double, ndim=1] z, np.ndarray [double, ndim=1] y, np.ndarray [double, ndim=2] H, float meanz=np.nan)</p>
<p>Fits the hermite coefficient (PCI)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z</strong> (<em>1D array of float64</em>) &#8211; Raw values sorted</li>
<li><strong>y</strong> (<em>1D array of float64</em>) &#8211; Gaussian values calculated for the right part of the bin.</li>
<li><strong>meanz</strong> (<em>float64, default np.nan</em>) &#8211; mean of z, if NaN then the mean will be calculated as np.mean(z)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>PCI</strong> (<em>1D array of floats</em>) &#8211; Hermite coefficients or PCI</li>
<li><strong>g</strong> (<em>1D array of floats</em>) &#8211; pdf value (g[i]) corresponding to each gaussian value (y[i])</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.nonlinear.var_PCI" title="pygslib.nonlinear.var_PCI"><code class="xref py py-func docutils literal"><span class="pre">var_PCI()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">PCI[0]=mean(z)</span></code> and  <code class="docutils literal"><span class="pre">sum=(PCI[1...n]^2)</span></code>. To validate the fit
calculate the variance with the function <code class="docutils literal"><span class="pre">var_PCI()</span></code> and compare
it with the experimental variance of <cite>z</cite>. You may also validate the
fit by calculating <code class="docutils literal"><span class="pre">error=</span> <span class="pre">z-PHI(y)</span></code>, where <code class="docutils literal"><span class="pre">PHI(y)</span></code> are the
<cite>z&#8217;</cite> values calculated with the hermite polynomial expansion.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.nonlinear.get_r">
<code class="descclassname">pygslib.nonlinear.</code><code class="descname">get_r</code><span class="sig-paren">(</span><em>double Var_Zv</em>, <em>np.ndarray [double</em>, <em>ndim=1] PCI</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.nonlinear.get_r" title="Permalink to this definition">¶</a></dt>
<dd><p>This function deduces the value of the support effect coefficient r
or the information effect coefficient, smoothing component, s
defined by the equations:</p>
<blockquote>
<div><p><span class="math">\(Var(Zv) = \sum PCI^2 * r^(n*2)\)</span></p>
<p>and</p>
<p><span class="math">\(Var(Zv*) = \sum PCI^2 * s^(n*2)\)</span></p>
</div></blockquote>
<p>The value of r is deduced by finding the root of the equation
f_var_Zv, using the classic Brent method (see scipy.optimize.brentq)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>PCI</strong> (<em>1D array of float64</em>) &#8211; hermite coefficient</li>
<li><strong>Var_Zv</strong> (<em>float64</em>) &#8211; Block variance</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>r</strong> &#8211; support effect coefficient r or information effect coefficient s</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float64</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.nonlinear.f_var_Zv" title="pygslib.nonlinear.f_var_Zv"><code class="xref py py-func docutils literal"><span class="pre">f_var_Zv()</span></code></a>, <a class="reference internal" href="#pygslib.nonlinear.fit_PCI" title="pygslib.nonlinear.fit_PCI"><code class="xref py py-func docutils literal"><span class="pre">fit_PCI()</span></code></a>, <code class="xref py py-func docutils literal"><span class="pre">scipy.optimize.brentq()</span></code></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>var(Zv) can be calculated as C(0)-gamma(v,v) or C(v,v) see function
block_covariance</p>
<p>var(Zv*) = var(Zv) - Kriging variance - 2*LaGrange multiplier</p>
<p class="last">In case of information effect this can be calculated with a dummy
dataset in a single block representing future information, for
example blast holes.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.nonlinear.get_ro">
<code class="descclassname">pygslib.nonlinear.</code><code class="descname">get_ro</code><span class="sig-paren">(</span><em>double Covar_ZvZv</em>, <em>np.ndarray [double</em>, <em>ndim=1] PCI</em>, <em>double r</em>, <em>double s</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.nonlinear.get_ro" title="Permalink to this definition">¶</a></dt>
<dd><p>This function deduces the information effect coefficient,
conditional bias component, ro defined by the equations:</p>
<blockquote>
<div><span class="math">\(Covar (Zv,Zv^*) = \sum PCI^2 * r^n * s^n * ro^n\)</span></div></blockquote>
<p>ro is necessary to account for the conditional bias in the
information effect.</p>
<p>The value of ro is deduced by finding the root of the equation
f_covar_ZvZv, using the classic Brent method (see
scipy.optimize.brentq)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>s</strong> (<em>r,</em>) &#8211; support effect and information effect (smoothing component)</li>
<li><strong>PCI</strong> (<em>1D array of floats</em>) &#8211; hermite coefficients</li>
<li><strong>Covar_ZvZv</strong> (<em>float</em>) &#8211; Block covariance (correlation) between true Zv and estimate Zv*</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><span class="math">\(Covar (Zv,Zv*) = var(Zv) - Kriging variance - LaGrange multiplier\)</span></p>
<p>see expression 7.47, page 97 on Basic Linear Geostatistics by
Margaret Armstrong.</p>
<p>In case of information effect this can be calculated with a dummy
dataset in a single block representing future information, for
example blast holes.</p>
<p>Note that the slop of regression is</p>
<p class="last"><span class="math">\(p = Covar (Zv,Zv^*) / (Covar (Zv,Zv^*)  - LaGrange multiplier)\)</span></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.nonlinear.recurrentH">
<code class="descclassname">pygslib.nonlinear.</code><code class="descname">recurrentH</code><span class="sig-paren">(</span><em>np.ndarray [double</em>, <em>ndim=1] y</em>, <em>int K=30</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.nonlinear.recurrentH" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the hermite polynomials with the recurrent formula</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>1D array of float64</em>) &#8211; Gaussian values calculated for the right part of the bin.</li>
<li><strong>K</strong> (<em>int32, default 30</em>) &#8211; Number of hermite polynomials</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>H</strong> &#8211; Hermite monomials H(i,y) with shape [K+1,len(y)]</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">2D array of float64</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-func docutils literal"><span class="pre">pygslib.gslib.__dist_transf.anatbl()</span></code></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The <cite>y</cite> values may be calculated on the right side of the bin,
as shown in fig VI.13, page 478 of Mining Geostatistics:
A. G. Journel, Andre G. Journel, C. J. The function
pygslib.gslib.__dist_transf.anatbl was prepared to provide these values,
considering declustering weight if necessary.</p>
<p class="last">The results from pygslib.gslib.__dist_transf.ns_ttable are inappropriate
for this calculation because are the mid interval in the bin.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pygslib.nonlinear.ttable">
<code class="descclassname">pygslib.nonlinear.</code><code class="descname">ttable</code><span class="sig-paren">(</span><em>np.ndarray [double</em>, <em>ndim=1] z</em>, <em>np.ndarray [double</em>, <em>ndim=1] w</em>, <em>long despkn=50</em>, <em>double despks=0.001</em>, <em>bint despkm=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.nonlinear.ttable" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a transformation table</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z,w</strong> (<em>1D numpy arrays of floats</em>) &#8211; variable and declustering weight</li>
<li><strong>despkn</strong> (<em>int64</em>) &#8211; number of despiking values</li>
<li><strong>despks</strong> (<em>float64</em>) &#8211; depiking value</li>
<li><strong>despkm</strong> (<em>boolean</em>) &#8211; if True the dat will be despiked before calculating the transformation table</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pygslib.nonlinear.var_PCI">
<code class="descclassname">pygslib.nonlinear.</code><code class="descname">var_PCI</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygslib.nonlinear.var_PCI" title="Permalink to this definition">¶</a></dt>
<dd><p>var_PCI(np.ndarray [double, ndim=1] PCI)</p>
<p>Calculates the variance from hermite coefficient (PCI)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>PCI</strong> (<em>1D array of float64</em>) &#8211; hermite coefficient</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>var</strong> &#8211; variance calculated with hermite polynomials</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float64</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pygslib.nonlinear.fit_PCI" title="pygslib.nonlinear.fit_PCI"><code class="xref py py-func docutils literal"><span class="pre">fit_PCI()</span></code></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The output may be used for validation of the PCI coefficients, it
may be close to the experimental variance of z.</p>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to PyGSLIB documentation!" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Adrian Martinez Vargas.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.0.3.8',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>